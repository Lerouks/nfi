var t="undefined"!=typeof window?window:void 0,e="undefined"!=typeof globalThis?globalThis:t;"undefined"==typeof self&&(e.self=e),"undefined"==typeof File&&(e.File=function(){});var i=Array.prototype,r=i.forEach,s=i.indexOf,n=null==e?void 0:e.navigator,o=null==e?void 0:e.document,a=null==e?void 0:e.location,l=null==e?void 0:e.fetch,u=null!=e&&e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest?e.XMLHttpRequest:void 0,h=null==e?void 0:e.AbortController,d=null==n?void 0:n.userAgent,v=null!=t?t:{},c={DEBUG:!1,LIB_VERSION:"1.354.3"};function f(t,e,i,r,s,n,o){try{var a=t[n](o),l=a.value}catch(t){return void i(t)}a.done?e(l):Promise.resolve(l).then(r,s)}function p(t){return function(){var e=this,i=arguments;return new Promise((function(r,s){var n=t.apply(e,i);function o(t){f(n,r,s,o,a,"next",t)}function a(t){f(n,r,s,o,a,"throw",t)}o(void 0)}))}}function _(){return _=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)({}).hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},_.apply(null,arguments)}var g=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"],m=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],y=function(t,e){if(void 0===e&&(e=[]),!t)return!1;var i=t.toLowerCase();return m.concat(e).some((t=>{var e=t.toLowerCase();return-1!==i.indexOf(e)}))};function b(t,e){return-1!==t.indexOf(e)}var w=function(t){return t.replace(/^\$/,"")};var x=Array.isArray,S=Object.prototype,E=S.hasOwnProperty,k=S.toString,P=x||function(t){return"[object Array]"===k.call(t)},F=t=>"function"==typeof t,I=t=>t===Object(t)&&!P(t),T=t=>{if(I(t)){for(var e in t)if(E.call(t,e))return!1;return!0}return!1},O=t=>void 0===t,R=t=>"[object String]"==k.call(t),M=t=>R(t)&&0===t.trim().length,C=t=>null===t,j=t=>O(t)||C(t),D=t=>"[object Number]"==k.call(t)&&t==t,A=t=>D(t)&&t>0,N=t=>"[object Boolean]"===k.call(t),U=t=>t instanceof FormData,L=t=>b(g,t);function z(t){return null===t||"object"!=typeof t}function B(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"}function H(t){return!O(Event)&&function(t,e){try{return t instanceof e}catch(t){return!1}}(t,Event)}var q=[!0,"true",1,"1","yes"],W=t=>b(q,t),G=[!1,"false",0,"0","no"];function J(t,e,i,r,s){return e>i&&(r.warn("min cannot be greater than max."),e=i),D(t)?t>i?(r.warn(" cannot be  greater than max: "+i+". Using max value instead."),i):t<e?(r.warn(" cannot be less than min: "+e+". Using min value instead."),e):t:(r.warn(" must be a number. using max or fallback. max: "+i+", fallback: "+s),J(s||i,e,i,r))}var V="Mobile",K="iOS",Y="Android",X="Tablet",Q=Y+" "+X,Z="iPad",tt="Apple",et=tt+" Watch",it="Safari",rt="BlackBerry",st="Samsung",nt=st+"Browser",ot=st+" Internet",at="Chrome",lt=at+" OS",ut=at+" "+K,ht="Internet Explorer",dt=ht+" "+V,vt="Opera",ct=vt+" Mini",ft="Edge",pt="Microsoft "+ft,_t="Firefox",gt=_t+" "+K,mt="Nintendo",yt="PlayStation",bt="Xbox",wt=Y+" "+V,xt=V+" "+it,$t="Windows",St=$t+" Phone",Et="Nokia",kt="Ouya",Pt="Generic",Ft=Pt+" "+V.toLowerCase(),It=Pt+" "+X.toLowerCase(),Tt="Konqueror",Ot="(\\d+(\\.\\d+)?)",Rt=new RegExp("Version/"+Ot),Mt=new RegExp(bt,"i"),Ct=new RegExp(yt+" \\w+","i"),jt=new RegExp(mt+" \\w+","i"),Dt=new RegExp(rt+"|PlayBook|BB10","i"),At={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"};var Nt,Ut,Lt,zt=(t,e)=>e&&b(e,tt)||function(t){return b(t,it)&&!b(t,at)&&!b(t,Y)}(t),Bt=function(t,e){return e=e||"",b(t," OPR/")&&b(t,"Mini")?ct:b(t," OPR/")?vt:Dt.test(t)?rt:b(t,"IE"+V)||b(t,"WPDesktop")?dt:b(t,nt)?ot:b(t,ft)||b(t,"Edg/")?pt:b(t,"FBIOS")?"Facebook "+V:b(t,"UCWEB")||b(t,"UCBrowser")?"UC Browser":b(t,"CriOS")?ut:b(t,"CrMo")||b(t,at)?at:b(t,Y)&&b(t,it)?wt:b(t,"FxiOS")?gt:b(t.toLowerCase(),Tt.toLowerCase())?Tt:zt(t,e)?b(t,V)?xt:it:b(t,_t)?_t:b(t,"MSIE")||b(t,"Trident/")?ht:b(t,"Gecko")?_t:""},Ht={[dt]:[new RegExp("rv:"+Ot)],[pt]:[new RegExp(ft+"?\\/"+Ot)],[at]:[new RegExp("("+at+"|CrMo)\\/"+Ot)],[ut]:[new RegExp("CriOS\\/"+Ot)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Ot)],[it]:[Rt],[xt]:[Rt],[vt]:[new RegExp("(Opera|OPR)\\/"+Ot)],[_t]:[new RegExp(_t+"\\/"+Ot)],[gt]:[new RegExp("FxiOS\\/"+Ot)],[Tt]:[new RegExp("Konqueror[:/]?"+Ot,"i")],[rt]:[new RegExp(rt+" "+Ot),Rt],[wt]:[new RegExp("android\\s"+Ot,"i")],[ot]:[new RegExp(nt+"\\/"+Ot)],[ht]:[new RegExp("(rv:|MSIE )"+Ot)],Mozilla:[new RegExp("rv:"+Ot)]},qt=function(t,e){var i=Bt(t,e),r=Ht[i];if(O(r))return null;for(var s=0;s<r.length;s++){var n=r[s],o=t.match(n);if(o)return parseFloat(o[o.length-2])}return null},Wt=[[new RegExp(bt+"; "+bt+" (.*?)[);]","i"),t=>[bt,t&&t[1]||""]],[new RegExp(mt,"i"),[mt,""]],[new RegExp(yt,"i"),[yt,""]],[Dt,[rt,""]],[new RegExp($t,"i"),(t,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[St,""];if(new RegExp(V).test(e)&&!/IEMobile\b/.test(e))return[$t+" "+V,""];var i=/Windows NT ([0-9.]+)/i.exec(e);if(i&&i[1]){var r=i[1],s=At[r]||"";return/arm/i.test(e)&&(s="RT"),[$t,s]}return[$t,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>{if(t&&t[3]){var e=[t[3],t[4],t[5]||"0"];return[K,e.join(".")]}return[K,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var e="";return t&&t.length>=3&&(e=O(t[2])?t[3]:t[2]),["watchOS",e]}],[new RegExp("("+Y+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Y+")","i"),t=>{if(t&&t[2]){var e=[t[2],t[3],t[4]||"0"];return[Y,e.join(".")]}return[Y,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var e=["Mac OS X",""];if(t&&t[1]){var i=[t[1],t[2],t[3]||"0"];e[1]=i.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[lt,""]],[/Linux|debian/i,["Linux",""]]],Gt=function(t){return jt.test(t)?mt:Ct.test(t)?yt:Mt.test(t)?bt:new RegExp(kt,"i").test(t)?kt:new RegExp("("+St+"|WPDesktop)","i").test(t)?St:/iPad/.test(t)?Z:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?et:Dt.test(t)?rt:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":new RegExp(Et,"i").test(t)?Et:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?new RegExp(V).test(t)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)||/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?Y:Q:new RegExp("(pda|"+V+")","i").test(t)?Ft:new RegExp(X,"i").test(t)&&!new RegExp(X+" pc","i").test(t)?It:""},Jt=t=>t instanceof Error;function Vt(t){var e=globalThis._posthogChunkIds;if(e){var i=Object.keys(e);return Lt&&i.length===Ut||(Ut=i.length,Lt=i.reduce(((i,r)=>{Nt||(Nt={});var s=Nt[r];if(s)i[s[0]]=s[1];else for(var n=t(r),o=n.length-1;o>=0;o--){var a=n[o],l=null==a?void 0:a.filename,u=e[r];if(l&&u){i[l]=u,Nt[r]=[l,u];break}}return i}),{})),Lt}}class Kt{constructor(t,e,i){void 0===i&&(i=[]),this.coercers=t,this.stackParser=e,this.modifiers=i}buildFromUnknown(t,e){void 0===e&&(e={});var i=e&&e.mechanism||{handled:!0,type:"generic"},r=this.buildCoercingContext(i,e,0).apply(t),s=this.buildParsingContext(e),n=this.parseStacktrace(r,s);return{$exception_list:this.convertToExceptionList(n,i),$exception_level:"error"}}modifyFrames(t){var e=this;return p((function*(){for(var i of t)i.stacktrace&&i.stacktrace.frames&&P(i.stacktrace.frames)&&(i.stacktrace.frames=yield e.applyModifiers(i.stacktrace.frames));return t}))()}coerceFallback(t){var e;return{type:"Error",value:"Unknown error",stack:null==(e=t.syntheticException)?void 0:e.stack,synthetic:!0}}parseStacktrace(t,e){var i,r;return null!=t.cause&&(i=this.parseStacktrace(t.cause,e)),""!=t.stack&&null!=t.stack&&(r=this.applyChunkIds(this.stackParser(t.stack,t.synthetic?e.skipFirstLines:0),e.chunkIdMap)),_({},t,{cause:i,stack:r})}applyChunkIds(t,e){return t.map((t=>(t.filename&&e&&(t.chunk_id=e[t.filename]),t)))}applyCoercers(t,e){for(var i of this.coercers)if(i.match(t))return i.coerce(t,e);return this.coerceFallback(e)}applyModifiers(t){var e=this;return p((function*(){var i=t;for(var r of e.modifiers)i=yield r(i);return i}))()}convertToExceptionList(t,e){var i,r,s,n={type:t.type,value:t.value,mechanism:{type:null!==(i=e.type)&&void 0!==i?i:"generic",handled:null===(r=e.handled)||void 0===r||r,synthetic:null!==(s=t.synthetic)&&void 0!==s&&s}};t.stack&&(n.stacktrace={type:"raw",frames:t.stack});var o=[n];return null!=t.cause&&o.push(...this.convertToExceptionList(t.cause,_({},e,{handled:!0}))),o}buildParsingContext(t){var e;return{chunkIdMap:Vt(this.stackParser),skipFirstLines:null!==(e=t.skipFirstLines)&&void 0!==e?e:1}}buildCoercingContext(t,e,i){void 0===i&&(i=0);var r=(i,r)=>{if(r<=4){var s=this.buildCoercingContext(t,e,r);return this.applyCoercers(i,s)}};return _({},e,{syntheticException:0==i?e.syntheticException:void 0,mechanism:t,apply:t=>r(t,i),next:t=>r(t,i+1)})}}var Yt="?";function Xt(t,e,i,r,s){var n={platform:t,filename:e,function:"<anonymous>"===i?Yt:i,in_app:!0};return O(r)||(n.lineno=r),O(s)||(n.colno=s),n}var Qt=(t,e)=>{var i=-1!==t.indexOf("safari-extension"),r=-1!==t.indexOf("safari-web-extension");return i||r?[-1!==t.indexOf("@")?t.split("@")[0]:Yt,i?"safari-extension:"+e:"safari-web-extension:"+e]:[t,e]},Zt=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,te=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ee=/\((\S*)(?::(\d+))(?::(\d+))\)/,ie=(t,e)=>{var i=Zt.exec(t);if(i){var[,r,s,n]=i;return Xt(e,r,Yt,+s,+n)}var o=te.exec(t);if(o){if(o[2]&&0===o[2].indexOf("eval")){var a=ee.exec(o[2]);a&&(o[2]=a[1],o[3]=a[2],o[4]=a[3])}var[l,u]=Qt(o[1]||Yt,o[2]);return Xt(e,u,l,o[3]?+o[3]:void 0,o[4]?+o[4]:void 0)}},re=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,se=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,ne=(t,e)=>{var i=re.exec(t);if(i){if(i[3]&&i[3].indexOf(" > eval")>-1){var r=se.exec(i[3]);r&&(i[1]=i[1]||"eval",i[3]=r[1],i[4]=r[2],i[5]="")}var s=i[3],n=i[1]||Yt;return[n,s]=Qt(n,s),Xt(e,s,n,i[4]?+i[4]:void 0,i[5]?+i[5]:void 0)}},oe=/\(error: (.*)\)/,ae=50;function le(){return function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(e,r){void 0===r&&(r=0);for(var s=[],n=e.split("\n"),o=r;o<n.length;o++){var a=n[o];if(!(a.length>1024)){var l=oe.test(a)?a.replace(oe,"$1"):a;if(!l.match(/\S*Error: /)){for(var u of i){var h=u(l,t);if(h){s.push(h);break}}if(s.length>=ae)break}}}return function(t){if(!t.length)return[];var e=Array.from(t);return e.reverse(),e.slice(0,ae).map((t=>{return _({},t,{filename:t.filename||(i=e,i[i.length-1]||{}).filename,function:t.function||Yt});var i}))}(s)}}("web:javascript",ie,ne)}class ue{match(t){return this.isDOMException(t)||this.isDOMError(t)}coerce(t,e){var i=R(t.stack);return{type:this.getType(t),value:this.getValue(t),stack:i?t.stack:void 0,cause:t.cause?e.next(t.cause):void 0,synthetic:!1}}getType(t){return this.isDOMError(t)?"DOMError":"DOMException"}getValue(t){var e=t.name||(this.isDOMError(t)?"DOMError":"DOMException");return t.message?e+": "+t.message:e}isDOMException(t){return B(t,"DOMException")}isDOMError(t){return B(t,"DOMError")}}class he{match(t){return(t=>t instanceof Error)(t)}coerce(t,e){return{type:this.getType(t),value:this.getMessage(t,e),stack:this.getStack(t),cause:t.cause?e.next(t.cause):void 0,synthetic:!1}}getType(t){return t.name||t.constructor.name}getMessage(t,e){var i=t.message;return i.error&&"string"==typeof i.error.message?String(i.error.message):String(i)}getStack(t){return t.stacktrace||t.stack||void 0}}class de{constructor(){}match(t){return B(t,"ErrorEvent")&&null!=t.error}coerce(t,e){var i,r=e.apply(t.error);return r||{type:"ErrorEvent",value:t.message,stack:null==(i=e.syntheticException)?void 0:i.stack,synthetic:!0}}}var ve=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class ce{match(t){return"string"==typeof t}coerce(t,e){var i,[r,s]=this.getInfos(t);return{type:null!=r?r:"Error",value:null!=s?s:t,stack:null==(i=e.syntheticException)?void 0:i.stack,synthetic:!0}}getInfos(t){var e="Error",i=t,r=t.match(ve);return r&&(e=r[1],i=r[2]),[e,i]}}var fe=["fatal","error","warning","log","info","debug"];function pe(t,e){void 0===e&&(e=40);var i=Object.keys(t);if(i.sort(),!i.length)return"[object has no keys]";for(var r=i.length;r>0;r--){var s=i.slice(0,r).join(", ");if(!(s.length>e))return r===i.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class _e{match(t){return"object"==typeof t&&null!==t}coerce(t,e){var i,r=this.getErrorPropertyFromObject(t);return r?e.apply(r):{type:this.getType(t),value:this.getValue(t),stack:null==(i=e.syntheticException)?void 0:i.stack,level:this.isSeverityLevel(t.level)?t.level:"error",synthetic:!0}}getType(t){return H(t)?t.constructor.name:"Error"}getValue(t){if("name"in t&&"string"==typeof t.name){var e="'"+t.name+"' captured as exception";return"message"in t&&"string"==typeof t.message&&(e+=" with message: '"+t.message+"'"),e}if("message"in t&&"string"==typeof t.message)return t.message;var i=this.getObjectClassName(t);return(i&&"Object"!==i?"'"+i+"'":"Object")+" captured as exception with keys: "+pe(t)}isSeverityLevel(t){return R(t)&&!M(t)&&fe.indexOf(t)>=0}getErrorPropertyFromObject(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e];if(Jt(i))return i}}getObjectClassName(t){try{var e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch(t){return}}}class ge{match(t){return H(t)}coerce(t,e){var i,r=t.constructor.name;return{type:r,value:r+" captured as exception with keys: "+pe(t),stack:null==(i=e.syntheticException)?void 0:i.stack,synthetic:!0}}}class me{match(t){return z(t)}coerce(t,e){var i;return{type:"Error",value:"Primitive value captured as exception: "+String(t),stack:null==(i=e.syntheticException)?void 0:i.stack,synthetic:!0}}}class ye{match(t){return B(t,"PromiseRejectionEvent")}coerce(t,e){var i,r=this.getUnhandledRejectionReason(t);return z(r)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(r),stack:null==(i=e.syntheticException)?void 0:i.stack,synthetic:!0}:e.apply(r)}getUnhandledRejectionReason(t){if(z(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch(t){}return t}}var be=function(e,i){var{debugEnabled:r}=void 0===i?{}:i,s={t:function(i){if(t&&(c.DEBUG||v.POSTHOG_DEBUG||r)&&!O(t.console)&&t.console){for(var s=("__rrweb_original__"in t.console[i]?t.console[i].__rrweb_original__:t.console[i]),n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];s(e,...o)}},info:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];s.t("log",...e)},warn:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];s.t("warn",...e)},error:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];s.t("error",...e)},critical:function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];console.error(e,...i)},uninitializedWarning:t=>{s.error("You must initialize PostHog before calling "+t)},createLogger:(t,i)=>be(e+" "+t,i)};return s},we=be("[PostHog.js]"),xe=we.createLogger,$e=xe("[ExternalScriptsLoader]"),Se=(t,e,i)=>{if(t.config.disable_external_dependency_loading)return $e.warn(e+" was requested but loading of external scripts is disabled."),i("Loading of external scripts is disabled");var r=null==o?void 0:o.querySelectorAll("script");if(r)for(var s,n=function(){if(r[a].src===e){var t=r[a];return t.__posthog_loading_callback_fired?{v:i()}:(t.addEventListener("load",(e=>{t.__posthog_loading_callback_fired=!0,i(void 0,e)})),t.onerror=t=>i(t),{v:void 0})}},a=0;a<r.length;a++)if(s=n())return s.v;var l=()=>{if(!o)return i("document not found");var r=o.createElement("script");if(r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.onload=t=>{r.__posthog_loading_callback_fired=!0,i(void 0,t)},r.onerror=t=>i(t),t.config.prepare_external_dependency_script&&(r=t.config.prepare_external_dependency_script(r)),!r)return i("prepare_external_dependency_script returned null");if("head"===t.config.external_scripts_inject_target)o.head.appendChild(r);else{var s,n=o.querySelectorAll("body > script");if(n.length>0)null==(s=n[0].parentNode)||s.insertBefore(r,n[0]);else o.body.appendChild(r)}};null!=o&&o.body?l():null==o||o.addEventListener("DOMContentLoaded",l)};v.__PosthogExtensions__=v.__PosthogExtensions__||{},v.__PosthogExtensions__.loadExternalDependency=(t,e,i)=>{var r="/static/"+e+".js?v="+t.version;if("remote-config"===e&&(r="/array/"+t.config.token+"/config.js"),"toolbar"===e){var s=3e5;r=r+"&t="+Math.floor(Date.now()/s)*s}var n=t.requestRouter.endpointFor("assets",r);Se(t,n,i)},v.__PosthogExtensions__.loadSiteApp=(t,e,i)=>{var r=t.requestRouter.endpointFor("api",e);Se(t,r,i)};var Ee={};function ke(t,e,i){if(P(t))if(r&&t.forEach===r)t.forEach(e,i);else if("length"in t&&t.length===+t.length)for(var s=0,n=t.length;s<n;s++)if(s in t&&e.call(i,t[s],s)===Ee)return}function Pe(t,e,i){if(!j(t)){if(P(t))return ke(t,e,i);if(U(t)){for(var r of t.entries())if(e.call(i,r[1],r[0])===Ee)return}else for(var s in t)if(E.call(t,s)&&e.call(i,t[s],s)===Ee)return}}var Fe=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return ke(i,(function(e){for(var i in e)void 0!==e[i]&&(t[i]=e[i])})),t},Ie=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return ke(i,(function(e){ke(e,(function(e){t.push(e)}))})),t};var Te=function(t){try{return t()}catch(t){return}},Oe=function(t){return function(){try{for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.apply(this,i)}catch(t){we.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),we.critical(t)}}},Re=function(t){var e={};return Pe(t,(function(t,i){(R(t)&&t.length>0||D(t))&&(e[i]=t)})),e};function Me(t,e){return i=t,r=t=>R(t)&&!C(e)?t.slice(0,e):t,s=new Set,function t(e,i){return e!==Object(e)?r?r(e,i):e:s.has(e)?void 0:(s.add(e),P(e)?(n=[],ke(e,(e=>{n.push(t(e))}))):(n={},Pe(e,((e,i)=>{s.has(e)||(n[i]=t(e,i))}))),n);var n}(i);var i,r,s}var Ce=["herokuapp.com","vercel.app","netlify.app"];function je(t){var e=null==t?void 0:t.hostname;if(!R(e))return!1;var i=e.split(".").slice(-2).join(".");for(var r of Ce)if(i===r)return!1;return!0}function De(t,e){for(var i=0;i<t.length;i++)if(e(t[i]))return t[i]}function Ae(t,e,i,r){var{capture:s=!1,passive:n=!0}=null!=r?r:{};null==t||t.addEventListener(e,i,{capture:s,passive:n})}function Ne(t){return"ph_toolbar_internal"===t.name}var Ue="$people_distinct_id",Le="__alias",ze="__timers",Be="$error_tracking_suppression_rules",He="$error_tracking_capture_extension_exceptions",qe="$sesid",We="$enabled_feature_flags",Ge="$early_access_features",Je="$feature_flag_details",Ve="$stored_person_properties",Ke="$stored_group_properties",Ye="$surveys",Xe="$flag_call_reported",Qe="$feature_flag_errors",Ze="$user_state",ti="$client_session_props",ei="$capture_rate_limit",ii="$initial_campaign_params",ri="$initial_referrer_info",si="$initial_person_info",ni="$epp",oi="$posthog_cookieless",ai=[Ue,Le,"__cmpns",ze,"$session_recording_enabled_server_side","$heatmaps_enabled_server_side",qe,We,Be,Ze,Ge,Je,Ke,Ve,Ye,Xe,Qe,ti,ei,ii,ri,ni,si];Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return D(t)&&isFinite(t)&&Math.floor(t)===t});var li="0123456789abcdef";class ui{constructor(t){if(this.bytes=t,16!==t.length)throw new TypeError("not 128-bit length")}static fromFieldsV7(t,e,i,r){if(!Number.isInteger(t)||!Number.isInteger(e)||!Number.isInteger(i)||!Number.isInteger(r)||t<0||e<0||i<0||r<0||t>0xffffffffffff||e>4095||i>1073741823||r>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=t/Math.pow(2,40),s[1]=t/Math.pow(2,32),s[2]=t/Math.pow(2,24),s[3]=t/Math.pow(2,16),s[4]=t/Math.pow(2,8),s[5]=t,s[6]=112|e>>>8,s[7]=e,s[8]=128|i>>>24,s[9]=i>>>16,s[10]=i>>>8,s[11]=i,s[12]=r>>>24,s[13]=r>>>16,s[14]=r>>>8,s[15]=r,new ui(s)}toString(){for(var t="",e=0;e<this.bytes.length;e++)t=t+li.charAt(this.bytes[e]>>>4)+li.charAt(15&this.bytes[e]),3!==e&&5!==e&&7!==e&&9!==e||(t+="-");if(36!==t.length)throw new Error("Invalid UUIDv7 was generated");return t}clone(){return new ui(this.bytes.slice(0))}equals(t){return 0===this.compareTo(t)}compareTo(t){for(var e=0;e<16;e++){var i=this.bytes[e]-t.bytes[e];if(0!==i)return Math.sign(i)}return 0}}class hi{constructor(){this.i=0,this.o=0,this.h=new ci}generate(){var t=this.generateOrAbort();if(O(t)){this.i=0;var e=this.generateOrAbort();if(O(e))throw new Error("Could not generate UUID after timestamp reset");return e}return t}generateOrAbort(){var t=Date.now();if(t>this.i)this.i=t,this.m();else{if(!(t+1e4>this.i))return;this.o++,this.o>4398046511103&&(this.i++,this.m())}return ui.fromFieldsV7(this.i,Math.trunc(this.o/Math.pow(2,30)),this.o&Math.pow(2,30)-1,this.h.nextUint32())}m(){this.o=1024*this.h.nextUint32()+(1023&this.h.nextUint32())}}var di,vi=t=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<t.length;e++)t[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};t&&!O(t.crypto)&&crypto.getRandomValues&&(vi=t=>crypto.getRandomValues(t));class ci{constructor(){this.$=new Uint32Array(8),this.S=1/0}nextUint32(){return this.S>=this.$.length&&(vi(this.$),this.S=0),this.$[this.S++]}}var fi=()=>pi().toString(),pi=()=>(di||(di=new hi)).generate(),_i="";var gi=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function mi(t,e){if(e){var i=function(t,e){if(void 0===e&&(e=o),_i)return _i;if(!e)return"";if(["localhost","127.0.0.1"].includes(t))return"";for(var i=t.split("."),r=Math.min(i.length,8),s="dmn_chk_"+fi();!_i&&r--;){var n=i.slice(r).join("."),a=s+"=1;domain=."+n+";path=/";e.cookie=a+";max-age=3",e.cookie.includes(s)&&(e.cookie=a+";max-age=0",_i=n)}return _i}(t);if(!i){var r=(t=>{var e=t.match(gi);return e?e[0]:""})(t);r!==i&&we.info("Warning: cookie subdomain discovery mismatch",r,i),i=r}return i?"; domain=."+i:""}return""}var yi={k:()=>!!o,P:function(t){we.error("cookieStore error: "+t)},F:function(t){if(o){try{for(var e=t+"=",i=o.cookie.split(";").filter((t=>t.length)),r=0;r<i.length;r++){for(var s=i[r];" "==s.charAt(0);)s=s.substring(1,s.length);if(0===s.indexOf(e))return decodeURIComponent(s.substring(e.length,s.length))}}catch(t){}return null}},I:function(t){var e;try{e=JSON.parse(yi.F(t))||{}}catch(t){}return e},T:function(t,e,i,r,s){if(o)try{var n="",a="",l=mi(o.location.hostname,r);if(i){var u=new Date;u.setTime(u.getTime()+24*i*60*60*1e3),n="; expires="+u.toUTCString()}s&&(a="; secure");var h=t+"="+encodeURIComponent(JSON.stringify(e))+n+"; SameSite=Lax; path=/"+l+a;return h.length>3686.4&&we.warn("cookieStore warning: large cookie, len="+h.length),o.cookie=h,h}catch(t){return}},O:function(t,e){if(null!=o&&o.cookie)try{yi.T(t,"",-1,e)}catch(t){return}}},bi=null,wi={k:function(){if(!C(bi))return bi;var e=!0;if(O(t))e=!1;else try{var i="__mplssupport__";wi.T(i,"xyz"),'"xyz"'!==wi.F(i)&&(e=!1),wi.O(i)}catch(t){e=!1}return e||we.error("localStorage unsupported; falling back to cookie store"),bi=e,e},P:function(t){we.error("localStorage error: "+t)},F:function(e){try{return null==t?void 0:t.localStorage.getItem(e)}catch(t){wi.P(t)}return null},I:function(t){try{return JSON.parse(wi.F(t))||{}}catch(t){}return null},T:function(e,i){try{null==t||t.localStorage.setItem(e,JSON.stringify(i))}catch(t){wi.P(t)}},O:function(e){try{null==t||t.localStorage.removeItem(e)}catch(t){wi.P(t)}}},xi=["$device_id","distinct_id",qe,"$session_is_sampled",ni,si,Ze],$i={},Si={k:function(){return!0},P:function(t){we.error("memoryStorage error: "+t)},F:function(t){return $i[t]||null},I:function(t){return $i[t]||null},T:function(t,e){$i[t]=e},O:function(t){delete $i[t]}},Ei=null,ki={k:function(){if(!C(Ei))return Ei;if(Ei=!0,O(t))Ei=!1;else try{var e="__support__";ki.T(e,"xyz"),'"xyz"'!==ki.F(e)&&(Ei=!1),ki.O(e)}catch(t){Ei=!1}return Ei},P:function(t){we.error("sessionStorage error: ",t)},F:function(e){try{return null==t?void 0:t.sessionStorage.getItem(e)}catch(t){ki.P(t)}return null},I:function(t){try{return JSON.parse(ki.F(t))||null}catch(t){}return null},T:function(e,i){try{null==t||t.sessionStorage.setItem(e,JSON.stringify(i))}catch(t){ki.P(t)}},O:function(e){try{null==t||t.sessionStorage.removeItem(e)}catch(t){ki.P(t)}}},Pi=function(t){return t[t.PENDING=-1]="PENDING",t[t.DENIED=0]="DENIED",t[t.GRANTED=1]="GRANTED",t}({});class Fi{constructor(t){this._instance=t}get R(){return this._instance.config}get consent(){return this.M()?Pi.DENIED:this.C}isOptedOut(){return"always"===this.R.cookieless_mode||(this.consent===Pi.DENIED||this.consent===Pi.PENDING&&(this.R.opt_out_capturing_by_default||"on_reject"===this.R.cookieless_mode))}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Pi.DENIED}optInOut(t){this.j.T(this.D,t?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.j.O(this.D,this.R.cross_subdomain_cookie)}get D(){var{token:t,opt_out_capturing_cookie_prefix:e,consent_persistence_name:i}=this._instance.config;return i||(e?e+t:"__ph_opt_in_out_"+t)}get C(){var t=this.j.F(this.D);return W(t)?Pi.GRANTED:b(G,t)?Pi.DENIED:Pi.PENDING}get j(){if(!this.A){var t=this.R.opt_out_capturing_persistence_type;this.A="localStorage"===t?wi:yi;var e="localStorage"===t?yi:wi;e.F(this.D)&&(this.A.F(this.D)||this.optInOut(W(e.F(this.D))),e.O(this.D,this.R.cross_subdomain_cookie))}return this.A}M(){return!!this.R.respect_dnt&&!!De([null==n?void 0:n.doNotTrack,null==n?void 0:n.msDoNotTrack,v.doNotTrack],(t=>W(t)))}}xe("[Dead Clicks]");var Ii=t=>{var e,i=!(null==(e=t.instance.persistence)||!e.get_property("$dead_clicks_enabled_server_side")),r=t.instance.config.capture_dead_clicks;return N(r)?r:!!I(r)||i},Ti=xe("[SegmentIntegration]");function Oi(t,e){var i=t.config.segment;if(!i)return e();!function(t,e){var i=t.config.segment;if(!i)return e();var r=i=>{var r=()=>i.anonymousId()||fi();t.config.get_device_id=r,i.id()&&(t.register({distinct_id:i.id(),$device_id:r()}),t.persistence.set_property(Ze,"identified")),e()},s=i.user();"then"in s&&F(s.then)?s.then(r):r(s)}(t,(()=>{i.register((t=>{Promise&&Promise.resolve||Ti.warn("This browser does not have Promise support, and can not use the segment integration");var e=(e,i)=>{if(!i)return e;e.event.userId||e.event.anonymousId===t.get_distinct_id()||(Ti.info("No userId set, resetting PostHog"),t.reset()),e.event.userId&&e.event.userId!==t.get_distinct_id()&&(Ti.info("UserId set, identifying with PostHog"),t.identify(e.event.userId));var r=t.calculateEventProperties(i,e.event.properties);return e.event.properties=Object.assign({},r,e.event.properties),e};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:t=>e(t,t.event.event),page:t=>e(t,"$pageview"),identify:t=>e(t,"$identify"),screen:t=>e(t,"$screen")}})(t)).then((()=>{e()}))}))}var Ri="posthog-js";function Mi(t,e){var{organization:i,projectId:r,prefix:s,severityAllowList:n=["error"],sendExceptionsToPostHog:o=!0}=void 0===e?{}:e;return e=>{var a,l,u,h,d;if(!("*"===n||n.includes(e.level))||!t.__loaded)return e;e.tags||(e.tags={});var v=t.requestRouter.endpointFor("ui","/project/"+t.config.token+"/person/"+t.get_distinct_id());e.tags["PostHog Person URL"]=v,t.sessionRecordingStarted()&&(e.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var c=(null==(a=e.exception)?void 0:a.values)||[],f=c.map((t=>_({},t,{stacktrace:t.stacktrace?_({},t.stacktrace,{type:"raw",frames:(t.stacktrace.frames||[]).map((t=>_({},t,{platform:"web:javascript"})))}):void 0}))),p={$exception_message:(null==(l=c[0])?void 0:l.value)||e.message,$exception_type:null==(u=c[0])?void 0:u.type,$exception_level:e.level,$exception_list:f,$sentry_event_id:e.event_id,$sentry_exception:e.exception,$sentry_exception_message:(null==(h=c[0])?void 0:h.value)||e.message,$sentry_exception_type:null==(d=c[0])?void 0:d.type,$sentry_tags:e.tags};return i&&r&&(p.$sentry_url=(s||"https://sentry.io/organizations/")+i+"/issues/?project="+r+"&query="+e.event_id),o&&t.exceptions.sendExceptionEvent(p),e}}class Ci{constructor(t,e,i,r,s,n){this.name=Ri,this.setupOnce=function(o){o(Mi(t,{organization:e,projectId:i,prefix:r,severityAllowList:s,sendExceptionsToPostHog:null==n||n}))}}}var ji=t=>{var e=null==o?void 0:o.createElement("a");return O(e)?null:(e.href=t,e)},Di=function(t,e){var i,r;void 0===e&&(e="&");var s=[];return Pe(t,(function(t,e){O(t)||O(e)||"undefined"===e||(i=encodeURIComponent((t=>t instanceof File)(t)?t.name:t.toString()),r=encodeURIComponent(e),s[s.length]=r+"="+i)})),s.join(e)},Ai=function(t,e){for(var i,r=((t.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<r.length;s++){var n=r[s].split("=");if(n[0]===e){i=n;break}}if(!P(i)||i.length<2)return"";var o=i[1];try{o=decodeURIComponent(o)}catch(t){we.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},Ni=function(t,e,i){if(!t||!e||!e.length)return t;for(var r=t.split("#"),s=r[0]||"",n=r[1],o=s.split("?"),a=o[1],l=o[0],u=(a||"").split("&"),h=[],d=0;d<u.length;d++){var v=u[d].split("=");P(v)&&(e.includes(v[0])?h.push(v[0]+"="+i):h.push(u[d]))}var c=l;return null!=a&&(c+="?"+h.join("&")),null!=n&&(c+="#"+n),c},Ui=function(t,e){var i=t.match(new RegExp(e+"=([^&]*)"));return i?i[1]:null},Li=null!=t&&t.location?Ui(t.location.hash,"__posthog")||Ui(location.hash,"state"):null,zi="_postHogToolbarParams",Bi=xe("[Toolbar]"),Hi=function(t){return t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED",t}(Hi||{});class qi{constructor(t){this.instance=t}N(t){v.ph_toolbar_state=t}U(){var t;return null!==(t=v.ph_toolbar_state)&&void 0!==t?t:Hi.UNINITIALIZED}maybeLoadToolbar(e,i,r){if(void 0===e&&(e=void 0),void 0===i&&(i=void 0),void 0===r&&(r=void 0),Ne(this.instance.config))return!1;if(!t||!o)return!1;e=null!=e?e:t.location,r=null!=r?r:t.history;try{if(!i){try{t.localStorage.setItem("test","test"),t.localStorage.removeItem("test")}catch(t){return!1}i=null==t?void 0:t.localStorage}var s,n=Li||Ui(e.hash,"__posthog")||Ui(e.hash,"state"),a=n?Te((()=>JSON.parse(atob(decodeURIComponent(n)))))||Te((()=>JSON.parse(decodeURIComponent(n)))):null;return a&&"ph_authorize"===a.action?((s=a).source="url",s&&Object.keys(s).length>0&&(a.desiredHash?e.hash=a.desiredHash:r?r.replaceState(r.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(i.getItem(zi)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch(t){return!1}}L(t){var e=v.ph_load_toolbar||v.ph_load_editor;!j(e)&&F(e)?e(t,this.instance):Bi.warn("No toolbar load function found")}loadToolbar(e){var i=!(null==o||!o.getElementById("__POSTHOG_TOOLBAR__"));if(!t||i)return!1;var r="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,s=_({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(t.localStorage.setItem(zi,JSON.stringify(_({},s,{source:void 0}))),this.U()===Hi.LOADED)this.L(s);else if(this.U()===Hi.UNINITIALIZED){var n;this.N(Hi.LOADING),null==(n=v.__PosthogExtensions__)||null==n.loadExternalDependency||n.loadExternalDependency(this.instance,"toolbar",(t=>{if(t)return Bi.error("[Toolbar] Failed to load",t),void this.N(Hi.UNINITIALIZED);this.N(Hi.LOADED),this.L(s)})),Ae(t,"turbolinks:load",(()=>{this.N(Hi.UNINITIALIZED),this.loadToolbar(s)}))}return!0}B(t){return this.loadToolbar(t)}maybeLoadEditor(t,e,i){return void 0===t&&(t=void 0),void 0===e&&(e=void 0),void 0===i&&(i=void 0),this.maybeLoadToolbar(t,e,i)}}class Wi{constructor(t){this.H=(t,e,i)=>{i&&(i.noSessionId||i.activityTimeout||i.sessionPastMaximumLength)&&(we.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:i}),this.q=void 0,this._instance.scrollManager.resetContext())},this._instance=t,this.W()}W(){var t;this.G=null==(t=this._instance.sessionManager)?void 0:t.onSessionId(this.H)}destroy(){var t;null==(t=this.G)||t.call(this),this.G=void 0}doPageView(e,i){var r,s=this.J(e,i);return this.q={pathname:null!==(r=null==t?void 0:t.location.pathname)&&void 0!==r?r:"",pageViewId:i,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(t){var e;return this.J(t,null==(e=this.q)?void 0:e.pageViewId)}doEvent(){var t;return{$pageview_id:null==(t=this.q)?void 0:t.pageViewId}}J(t,e){var i=this.q;if(!i)return{$pageview_id:e};var r={$pageview_id:e,$prev_pageview_id:i.pageViewId},s=this._instance.scrollManager.getContext();if(s&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:n,lastScrollY:o,maxScrollY:a,maxContentHeight:l,lastContentY:u,maxContentY:h}=s;if(!(O(n)||O(o)||O(a)||O(l)||O(u)||O(h))){n=Math.ceil(n),o=Math.ceil(o),a=Math.ceil(a),l=Math.ceil(l),u=Math.ceil(u),h=Math.ceil(h);var d=n<=1?1:J(o/n,0,1,we),v=n<=1?1:J(a/n,0,1,we),c=l<=1?1:J(u/l,0,1,we),f=l<=1?1:J(h/l,0,1,we);r=Fe(r,{$prev_pageview_last_scroll:o,$prev_pageview_last_scroll_percentage:d,$prev_pageview_max_scroll:a,$prev_pageview_max_scroll_percentage:v,$prev_pageview_last_content:u,$prev_pageview_last_content_percentage:c,$prev_pageview_max_content:h,$prev_pageview_max_content_percentage:f})}}return i.pathname&&(r.$prev_pageview_pathname=i.pathname),i.timestamp&&(r.$prev_pageview_duration=(t.getTime()-i.timestamp.getTime())/1e3),r}}var Gi=["fatal","error","warning","log","info","debug"],Ji=function(t){return t.GZipJS="gzip-js",t.Base64="base64",t}({}),Vi=Uint8Array,Ki=Uint16Array,Yi=Uint32Array,Xi=new Vi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qi=new Vi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Zi=new Vi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tr=function(t,e){for(var i=new Ki(31),r=0;r<31;++r)i[r]=e+=1<<t[r-1];var s=new Yi(i[30]);for(r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return[i,s]},er=tr(Xi,2),ir=er[0],rr=er[1];ir[28]=258,rr[258]=28;for(var sr=tr(Qi,0)[1],nr=new Ki(32768),or=0;or<32768;++or){var ar=(43690&or)>>>1|(21845&or)<<1;ar=(61680&(ar=(52428&ar)>>>2|(13107&ar)<<2))>>>4|(3855&ar)<<4,nr[or]=((65280&ar)>>>8|(255&ar)<<8)>>>1}var lr=function(t,e,i){for(var r=t.length,s=0,n=new Ki(e);s<r;++s)++n[t[s]-1];var o,a=new Ki(e);for(s=0;s<e;++s)a[s]=a[s-1]+n[s-1]<<1;if(i){o=new Ki(1<<e);var l=15-e;for(s=0;s<r;++s)if(t[s])for(var u=s<<4|t[s],h=e-t[s],d=a[t[s]-1]++<<h,v=d|(1<<h)-1;d<=v;++d)o[nr[d]>>>l]=u}else for(o=new Ki(r),s=0;s<r;++s)o[s]=nr[a[t[s]-1]++]>>>15-t[s];return o},ur=new Vi(288);for(or=0;or<144;++or)ur[or]=8;for(or=144;or<256;++or)ur[or]=9;for(or=256;or<280;++or)ur[or]=7;for(or=280;or<288;++or)ur[or]=8;var hr=new Vi(32);for(or=0;or<32;++or)hr[or]=5;var dr=lr(ur,9,0),vr=lr(hr,5,0),cr=function(t){return(t/8>>0)+(7&t&&1)},fr=function(t,e,i){(null==i||i>t.length)&&(i=t.length);var r=new(t instanceof Ki?Ki:t instanceof Yi?Yi:Vi)(i-e);return r.set(t.subarray(e,i)),r},pr=function(t,e,i){i<<=7&e;var r=e/8>>0;t[r]|=i,t[r+1]|=i>>>8},_r=function(t,e,i){i<<=7&e;var r=e/8>>0;t[r]|=i,t[r+1]|=i>>>8,t[r+2]|=i>>>16},gr=function(t,e){for(var i=[],r=0;r<t.length;++r)t[r]&&i.push({s:r,f:t[r]});var s=i.length,n=i.slice();if(!s)return[new Vi(0),0];if(1==s){var o=new Vi(i[0].s+1);return o[i[0].s]=1,[o,1]}i.sort((function(t,e){return t.f-e.f})),i.push({s:-1,f:25001});var a=i[0],l=i[1],u=0,h=1,d=2;for(i[0]={s:-1,f:a.f+l.f,l:a,r:l};h!=s-1;)a=i[i[u].f<i[d].f?u++:d++],l=i[u!=h&&i[u].f<i[d].f?u++:d++],i[h++]={s:-1,f:a.f+l.f,l:a,r:l};var v=n[0].s;for(r=1;r<s;++r)n[r].s>v&&(v=n[r].s);var c=new Ki(v+1),f=mr(i[h-1],c,0);if(f>e){r=0;var p=0,_=f-e,g=1<<_;for(n.sort((function(t,e){return c[e.s]-c[t.s]||t.f-e.f}));r<s;++r){var m=n[r].s;if(!(c[m]>e))break;p+=g-(1<<f-c[m]),c[m]=e}for(p>>>=_;p>0;){var y=n[r].s;c[y]<e?p-=1<<e-c[y]++-1:++r}for(;r>=0&&p;--r){var b=n[r].s;c[b]==e&&(--c[b],++p)}f=e}return[new Vi(c),f]},mr=function(t,e,i){return-1==t.s?Math.max(mr(t.l,e,i+1),mr(t.r,e,i+1)):e[t.s]=i},yr=function(t){for(var e=t.length;e&&!t[--e];);for(var i=new Ki(++e),r=0,s=t[0],n=1,o=function(t){i[r++]=t},a=1;a<=e;++a)if(t[a]==s&&a!=e)++n;else{if(!s&&n>2){for(;n>138;n-=138)o(32754);n>2&&(o(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(o(s),--n;n>6;n-=6)o(8304);n>2&&(o(n-3<<5|8208),n=0)}for(;n--;)o(s);n=1,s=t[a]}return[i.subarray(0,r),e]},br=function(t,e){for(var i=0,r=0;r<e.length;++r)i+=t[r]*e[r];return i},wr=function(t,e,i){var r=i.length,s=cr(e+2);t[s]=255&r,t[s+1]=r>>>8,t[s+2]=255^t[s],t[s+3]=255^t[s+1];for(var n=0;n<r;++n)t[s+n+4]=i[n];return 8*(s+4+r)},xr=function(t,e,i,r,s,n,o,a,l,u,h){pr(e,h++,i),++s[256];for(var d=gr(s,15),v=d[0],c=d[1],f=gr(n,15),p=f[0],_=f[1],g=yr(v),m=g[0],y=g[1],b=yr(p),w=b[0],x=b[1],S=new Ki(19),E=0;E<m.length;++E)S[31&m[E]]++;for(E=0;E<w.length;++E)S[31&w[E]]++;for(var k=gr(S,7),P=k[0],F=k[1],I=19;I>4&&!P[Zi[I-1]];--I);var T,O,R,M,C=u+5<<3,j=br(s,ur)+br(n,hr)+o,D=br(s,v)+br(n,p)+o+14+3*I+br(S,P)+(2*S[16]+3*S[17]+7*S[18]);if(C<=j&&C<=D)return wr(e,h,t.subarray(l,l+u));if(pr(e,h,1+(D<j)),h+=2,D<j){T=lr(v,c,0),O=v,R=lr(p,_,0),M=p;var A=lr(P,F,0);pr(e,h,y-257),pr(e,h+5,x-1),pr(e,h+10,I-4),h+=14;for(E=0;E<I;++E)pr(e,h+3*E,P[Zi[E]]);h+=3*I;for(var N=[m,w],U=0;U<2;++U){var L=N[U];for(E=0;E<L.length;++E){var z=31&L[E];pr(e,h,A[z]),h+=P[z],z>15&&(pr(e,h,L[E]>>>5&127),h+=L[E]>>>12)}}}else T=dr,O=ur,R=vr,M=hr;for(E=0;E<a;++E)if(r[E]>255){z=r[E]>>>18&31;_r(e,h,T[z+257]),h+=O[z+257],z>7&&(pr(e,h,r[E]>>>23&31),h+=Xi[z]);var B=31&r[E];_r(e,h,R[B]),h+=M[B],B>3&&(_r(e,h,r[E]>>>5&8191),h+=Qi[B])}else _r(e,h,T[r[E]]),h+=O[r[E]];return _r(e,h,T[256]),h+O[256]},$r=new Yi([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sr=function(){for(var t=new Yi(256),e=0;e<256;++e){for(var i=e,r=9;--r;)i=(1&i&&3988292384)^i>>>1;t[e]=i}return t}(),Er=function(t,e,i,r,s){return function(t,e,i,r,s,n){var o=t.length,a=new Vi(r+o+5*(1+Math.floor(o/7e3))+s),l=a.subarray(r,a.length-s),u=0;if(!e||o<8)for(var h=0;h<=o;h+=65535){var d=h+65535;d<o?u=wr(l,u,t.subarray(h,d)):(l[h]=n,u=wr(l,u,t.subarray(h,o)))}else{for(var v=$r[e-1],c=v>>>13,f=8191&v,p=(1<<i)-1,_=new Ki(32768),g=new Ki(p+1),m=Math.ceil(i/3),y=2*m,b=function(e){return(t[e]^t[e+1]<<m^t[e+2]<<y)&p},w=new Yi(25e3),x=new Ki(288),S=new Ki(32),E=0,k=0,P=(h=0,0),F=0,I=0;h<o;++h){var T=b(h),O=32767&h,R=g[T];if(_[O]=R,g[T]=O,F<=h){var M=o-h;if((E>7e3||P>24576)&&M>423){u=xr(t,l,0,w,x,S,k,P,I,h-I,u),P=E=k=0,I=h;for(var C=0;C<286;++C)x[C]=0;for(C=0;C<30;++C)S[C]=0}var j=2,D=0,A=f,N=O-R&32767;if(M>2&&T==b(h-N))for(var U=Math.min(c,M)-1,L=Math.min(32767,h),z=Math.min(258,M);N<=L&&--A&&O!=R;){if(t[h+j]==t[h+j-N]){for(var B=0;B<z&&t[h+B]==t[h+B-N];++B);if(B>j){if(j=B,D=N,B>U)break;var H=Math.min(N,B-2),q=0;for(C=0;C<H;++C){var W=h-N+C+32768&32767,G=W-_[W]+32768&32767;G>q&&(q=G,R=W)}}}N+=(O=R)-(R=_[O])+32768&32767}if(D){w[P++]=268435456|rr[j]<<18|sr[D];var J=31&rr[j],V=31&sr[D];k+=Xi[J]+Qi[V],++x[257+J],++S[V],F=h+j,++E}else w[P++]=t[h],++x[t[h]]}}u=xr(t,l,n,w,x,S,k,P,I,h-I,u)}return fr(a,0,r+cr(u)+s)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,i,r,!0)},kr=function(t,e,i){for(;i;++e)t[e]=i,i>>>=8};function Pr(t,e){void 0===e&&(e={});var i=function(){var t=4294967295;return{p:function(e){for(var i=t,r=0;r<e.length;++r)i=Sr[255&i^e[r]]^i>>>8;t=i},d:function(){return 4294967295^t}}}(),r=t.length;i.p(t);var s,n=Er(t,e,10+((s=e).filename&&s.filename.length+1||0),8),o=n.length;return function(t,e){var i=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&kr(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),i){t[3]=8;for(var r=0;r<=i.length;++r)t[r+10]=i.charCodeAt(r)}}(n,e),kr(n,o-8,i.d()),kr(n,o-4,r),n}var Fr=function(t){var e,i,r,s,n="";for(e=i=0,r=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,s=0;s<r;s++){var o=t.charCodeAt(s),a=null;o<128?i++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),C(a)||(i>e&&(n+=t.substring(e,i)),n+=a,e=i=s+1)}return i>e&&(n+=t.substring(e,t.length)),n},Ir=!!u||!!l,Tr="text/plain",Or=function(t,e,i){var r;void 0===i&&(i=!0);var[s,n]=t.split("?"),o=_({},e),a=null!==(r=null==n?void 0:n.split("&").map((t=>{var e,[r,s]=t.split("="),n=i&&null!==(e=o[r])&&void 0!==e?e:s;return delete o[r],r+"="+n})))&&void 0!==r?r:[],l=Di(o);return l&&a.push(l),s+"?"+a.join("&")},Rr=(t,e)=>JSON.stringify(t,((t,e)=>"bigint"==typeof e?e.toString():e),e),Mr=t=>{var{data:e,compression:i}=t;if(e){if(i===Ji.GZipJS){var r=Pr(function(t,e){var i=t.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t);for(var r=new Vi(t.length+(t.length>>>1)),s=0,n=function(t){r[s++]=t},o=0;o<i;++o){if(s+5>r.length){var a=new Vi(s+8+(i-o<<1));a.set(r),r=a}var l=t.charCodeAt(o);l<128||e?n(l):l<2048?(n(192|l>>>6),n(128|63&l)):l>55295&&l<57344?(n(240|(l=65536+(1047552&l)|1023&t.charCodeAt(++o))>>>18),n(128|l>>>12&63),n(128|l>>>6&63),n(128|63&l)):(n(224|l>>>12),n(128|l>>>6&63),n(128|63&l))}return fr(r,0,s)}(Rr(e)),{mtime:0}),s=new Blob([r],{type:Tr});return{contentType:Tr,body:s,estimatedSize:s.size}}if(i===Ji.Base64){var n=function(t){var e,i,r,s,n,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,u="",h=[];if(!t)return t;t=Fr(t);do{e=(n=t.charCodeAt(a++)<<16|t.charCodeAt(a++)<<8|t.charCodeAt(a++))>>18&63,i=n>>12&63,r=n>>6&63,s=63&n,h[l++]=o.charAt(e)+o.charAt(i)+o.charAt(r)+o.charAt(s)}while(a<t.length);switch(u=h.join(""),t.length%3){case 1:u=u.slice(0,-2)+"==";break;case 2:u=u.slice(0,-1)+"="}return u}(Rr(e)),o=(t=>"data="+encodeURIComponent("string"==typeof t?t:Rr(t)))(n);return{contentType:"application/x-www-form-urlencoded",body:o,estimatedSize:new Blob([o]).size}}var a=Rr(e);return{contentType:"application/json",body:a,estimatedSize:new Blob([a]).size}}},Cr=[];l&&Cr.push({transport:"fetch",method:t=>{var e,i,{contentType:r,body:s,estimatedSize:n}=null!==(e=Mr(t))&&void 0!==e?e:{},o=new Headers;Pe(t.headers,(function(t,e){o.append(e,t)})),r&&o.append("Content-Type",r);var a=t.url,u=null;if(h){var d=new h;u={signal:d.signal,timeout:setTimeout((()=>d.abort()),t.timeout)}}l(a,_({method:(null==t?void 0:t.method)||"GET",headers:o,keepalive:"POST"===t.method&&(n||0)<52428.8,body:s,signal:null==(i=u)?void 0:i.signal},t.fetchOptions)).then((e=>e.text().then((i=>{var r={statusCode:e.status,text:i};if(200===e.status)try{r.json=JSON.parse(i)}catch(t){we.error(t)}null==t.callback||t.callback(r)})))).catch((e=>{we.error(e),null==t.callback||t.callback({statusCode:0,error:e})})).finally((()=>u?clearTimeout(u.timeout):null))}}),u&&Cr.push({transport:"XHR",method:t=>{var e,i=new u;i.open(t.method||"GET",t.url,!0);var{contentType:r,body:s}=null!==(e=Mr(t))&&void 0!==e?e:{};Pe(t.headers,(function(t,e){i.setRequestHeader(e,t)})),r&&i.setRequestHeader("Content-Type",r),t.timeout&&(i.timeout=t.timeout),t.disableXHRCredentials||(i.withCredentials=!0),i.onreadystatechange=()=>{if(4===i.readyState){var e={statusCode:i.status,text:i.responseText};if(200===i.status)try{e.json=JSON.parse(i.responseText)}catch(t){}null==t.callback||t.callback(e)}},i.send(s)}}),null!=n&&n.sendBeacon&&Cr.push({transport:"sendBeacon",method:t=>{var e=Or(t.url,{beacon:"1"});try{var i,{contentType:r,body:s}=null!==(i=Mr(t))&&void 0!==i?i:{},o="string"==typeof s?new Blob([s],{type:r}):s;n.sendBeacon(e,o)}catch(t){}}});var jr=function(t,e){if(!function(t){try{new RegExp(t)}catch(t){return!1}return!0}(e))return!1;try{return new RegExp(e).test(t)}catch(t){return!1}};function Dr(t,e,i){return Rr({distinct_id:t,userPropertiesToSet:e,userPropertiesToSetOnce:i})}var Ar={exact:(t,e)=>e.some((e=>t.some((t=>e===t)))),is_not:(t,e)=>e.every((e=>t.every((t=>e!==t)))),regex:(t,e)=>e.some((e=>t.some((t=>jr(e,t))))),not_regex:(t,e)=>e.every((e=>t.every((t=>!jr(e,t))))),icontains:(t,e)=>e.map(Nr).some((e=>t.map(Nr).some((t=>e.includes(t))))),not_icontains:(t,e)=>e.map(Nr).every((e=>t.map(Nr).every((t=>!e.includes(t))))),gt:(t,e)=>e.some((e=>{var i=parseFloat(e);return!isNaN(i)&&t.some((t=>i>parseFloat(t)))})),lt:(t,e)=>e.some((e=>{var i=parseFloat(e);return!isNaN(i)&&t.some((t=>i<parseFloat(t)))}))},Nr=t=>t.toLowerCase();function Ur(t,e){return!t||Object.entries(t).every((t=>{var[i,r]=t,s=null==e?void 0:e[i];if(O(s)||C(s))return!1;var n=[String(s)],o=Ar[r.operator];return!!o&&o(r.values,n)}))}var Lr=xe("[Error tracking]");class zr{constructor(t){var e,i;this.V=[],this.K=new Kt([new ue,new ye,new de,new he,new ge,new _e,new ce,new me],le()),this._instance=t,this.V=null!==(e=null==(i=this._instance.persistence)?void 0:i.get_property(Be))&&void 0!==e?e:[]}onRemoteConfig(t){var e,i,r;if("errorTracking"in t){var s=null!==(e=null==(i=t.errorTracking)?void 0:i.suppressionRules)&&void 0!==e?e:[],n=null==(r=t.errorTracking)?void 0:r.captureExtensionExceptions;this.V=s,this._instance.persistence&&this._instance.persistence.register({[Be]:this.V,[He]:n})}}get Y(){var t,e=!!this._instance.get_property(He),i=this._instance.config.error_tracking.captureExtensionExceptions;return null!==(t=null!=i?i:e)&&void 0!==t&&t}buildProperties(t,e){return this.K.buildFromUnknown(t,{syntheticException:null==e?void 0:e.syntheticException,mechanism:{handled:null==e?void 0:e.handled}})}sendExceptionEvent(t){var e=t.$exception_list;if(this.X(e)){if(this.Z(e))return void Lr.info("Skipping exception capture because a suppression rule matched");if(!this.Y&&this.tt(e))return void Lr.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.et(e))return void Lr.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",t,{_noTruncate:!0,_batchKey:"exceptionEvent",it:!0})}Z(t){if(0===t.length)return!1;var e=t.reduce(((t,e)=>{var{type:i,value:r}=e;return R(i)&&i.length>0&&t.$exception_types.push(i),R(r)&&r.length>0&&t.$exception_values.push(r),t}),{$exception_types:[],$exception_values:[]});return this.V.some((t=>{var i=t.values.map((t=>{var i,r=Ar[t.operator],s=P(t.value)?t.value:[t.value],n=null!==(i=e[t.key])&&void 0!==i?i:[];return s.length>0&&r(s,n)}));return"OR"===t.type?i.some(Boolean):i.every(Boolean)}))}tt(t){return t.flatMap((t=>{var e,i;return null!==(e=null==(i=t.stacktrace)?void 0:i.frames)&&void 0!==e?e:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}et(t){if(t.length>0){var e,i,r,s,n=null!==(e=null==(i=t[0].stacktrace)?void 0:i.frames)&&void 0!==e?e:[],o=n[n.length-1];return null!==(r=null==o||null==(s=o.filename)?void 0:s.includes("posthog.com/static"))&&void 0!==r&&r}return!1}X(t){return!j(t)&&P(t)}}var Br="https?://(.*)",Hr=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],qr=Ie(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],Hr),Wr="<masked>",Gr=["li_fat_id"];function Jr(t,e,i){if(!o)return{};var r,s=e?Ie([],Hr,i||[]):[],n=Vr(Ni(o.URL,s,Wr),t),a=(r={},Pe(Gr,(function(t){var e=yi.F(t);r[t]=e||null})),r);return Fe(a,n)}function Vr(t,e){var i=qr.concat(e||[]),r={};return Pe(i,(function(e){var i=Ai(t,e);r[e]=i||null})),r}function Kr(t){var e=function(t){return t?0===t.search(Br+"google.([^/?]*)")?"google":0===t.search(Br+"bing.com")?"bing":0===t.search(Br+"yahoo.com")?"yahoo":0===t.search(Br+"duckduckgo.com")?"duckduckgo":null:null}(t),i="yahoo"!=e?"q":"p",r={};if(!C(e)){r.$search_engine=e;var s=o?Ai(o.referrer,i):"";s.length&&(r.ph_keyword=s)}return r}function Yr(){return navigator.language||navigator.userLanguage}function Xr(){return(null==o?void 0:o.referrer)||"$direct"}function Qr(t,e){var i=t?Ie([],Hr,e||[]):[],r=null==a?void 0:a.href.substring(0,1e3);return{r:Xr().substring(0,1e3),u:r?Ni(r,i,Wr):void 0}}function Zr(t){var e,{r:i,u:r}=t,s={$referrer:i,$referring_domain:null==i?void 0:"$direct"==i?"$direct":null==(e=ji(i))?void 0:e.host};if(r){s.$current_url=r;var n=ji(r);s.$host=null==n?void 0:n.host,s.$pathname=null==n?void 0:n.pathname;var o=Vr(r);Fe(s,o)}if(i){var a=Kr(i);Fe(s,a)}return s}function ts(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){return}}function es(){try{return(new Date).getTimezoneOffset()}catch(t){return}}function is(e,i){if(!d)return{};var r,s,n,o=e?Ie([],Hr,i||[]):[],[l,u]=function(t){for(var e=0;e<Wt.length;e++){var[i,r]=Wt[e],s=i.exec(t),n=s&&(F(r)?r(s,t):r);if(n)return n}return["",""]}(d);return Fe(Re({$os:l,$os_version:u,$browser:Bt(d,navigator.vendor),$device:Gt(d),$device_type:(s=d,n=Gt(s),n===Z||n===Q||"Kobo"===n||"Kindle Fire"===n||n===It?X:n===mt||n===bt||n===yt||n===kt?"Console":n===et?"Wearable":n?V:"Desktop"),$timezone:ts(),$timezone_offset:es()}),{$current_url:Ni(null==a?void 0:a.href,o,Wr),$host:null==a?void 0:a.host,$pathname:null==a?void 0:a.pathname,$raw_user_agent:d.length>1e3?d.substring(0,997)+"...":d,$browser_version:qt(d,navigator.vendor),$browser_language:Yr(),$browser_language_prefix:(r=Yr(),"string"==typeof r?r.split("-")[0]:void 0),$screen_height:null==t?void 0:t.screen.height,$screen_width:null==t?void 0:t.screen.width,$viewport_height:null==t?void 0:t.innerHeight,$viewport_width:null==t?void 0:t.innerWidth,$lib:"web",$lib_version:c.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var rs=xe("[FeatureFlags]"),ss=xe("[FeatureFlags]",{debugEnabled:!0}),ns="errors_while_computing_flags",os="flag_missing",as="quota_limited",ls="timeout",us="connection_error",hs="unknown_error",ds=t=>"api_error_"+t,vs="$active_feature_flags",cs="$override_feature_flags",fs="$feature_flag_payloads",ps="$override_feature_flag_payloads",_s="$feature_flag_request_id",gs="$feature_flag_evaluated_at",ms=t=>{var e={};for(var[i,r]of function(t){for(var e=Object.keys(t),i=e.length,r=new Array(i);i--;)r[i]=[e[i],t[e[i]]];return r}(t||{}))r&&(e[i]=r);return e},ys=t=>{var e=t.flags;return e?(t.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var i;return[t,null!==(i=e[t].variant)&&void 0!==i?i:e[t].enabled]}))),t.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var i;return null==(i=e[t].metadata)?void 0:i.payload})).map((t=>{var i;return[t,null==(i=e[t].metadata)?void 0:i.payload]})))):rs.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),t},bs=function(t){return t.FeatureFlags="feature_flags",t.Recordings="recordings",t}({});class ws{constructor(t){this.rt=!1,this.st=!1,this.nt=!1,this.ot=!1,this.ut=!1,this.ht=!1,this.dt=!1,this._instance=t,this.featureFlagEventHandlers=[]}vt(){var t,e=null!==(t=this._instance.config.evaluation_contexts)&&void 0!==t?t:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.dt||(rs.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.dt=!0),null!=e&&e.length?e.filter((t=>{var e=t&&"string"==typeof t&&t.trim().length>0;return e||rs.error("Invalid evaluation context found:",t,"Expected non-empty string"),e})):[]}ct(){return this.vt().length>0}get hasLoadedFlags(){return this.st}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var t=this._instance.get_property(Je),e=this._instance.get_property(cs),i=this._instance.get_property(ps);if(!i&&!e)return t||{};var r=Fe({},t||{}),s=[...new Set([...Object.keys(i||{}),...Object.keys(e||{})])];for(var n of s){var o,a,l=r[n],u=null==e?void 0:e[n],h=O(u)?null!==(o=null==l?void 0:l.enabled)&&void 0!==o&&o:!!u,d=O(u)?l.variant:"string"==typeof u?u:void 0,v=null==i?void 0:i[n],c=_({},l,{enabled:h,variant:h?null!=d?d:null==l?void 0:l.variant:void 0});if(h!==(null==l?void 0:l.enabled)&&(c.original_enabled=null==l?void 0:l.enabled),d!==(null==l?void 0:l.variant)&&(c.original_variant=null==l?void 0:l.variant),v)c.metadata=_({},null==l?void 0:l.metadata,{payload:v,original_payload:null==l||null==(a=l.metadata)?void 0:a.payload});r[n]=c}return this.rt||(rs.warn(" Overriding feature flag details!",{flagDetails:t,overriddenPayloads:i,finalDetails:r}),this.rt=!0),r}getFlagVariants(){var t=this._instance.get_property(We),e=this._instance.get_property(cs);if(!e)return t||{};for(var i=Fe({},t),r=Object.keys(e),s=0;s<r.length;s++)i[r[s]]=e[r[s]];return this.rt||(rs.warn(" Overriding feature flags!",{enabledFlags:t,overriddenFlags:e,finalFlags:i}),this.rt=!0),i}getFlagPayloads(){var t=this._instance.get_property(fs),e=this._instance.get_property(ps);if(!e)return t||{};for(var i=Fe({},t||{}),r=Object.keys(e),s=0;s<r.length;s++)i[r[s]]=e[r[s]];return this.rt||(rs.warn(" Overriding feature flag payloads!",{flagPayloads:t,overriddenPayloads:e,finalPayloads:i}),this.rt=!0),i}reloadFeatureFlags(){this.ot||this._instance.config.advanced_disable_feature_flags||this.ft||(this._instance._t.emit("featureFlagsReloading",!0),this.ft=setTimeout((()=>{this.yt()}),5))}bt(){clearTimeout(this.ft),this.ft=void 0}ensureFlagsLoaded(){this.st||this.nt||this.ft||this.reloadFeatureFlags()}setAnonymousDistinctId(t){this.$anon_distinct_id=t}setReloadingPaused(t){this.ot=t}yt(t){var e;if(this.bt(),!this._instance.wt())if(this.nt)this.ut=!0;else{var i=this._instance.config.token,r=this._instance.get_property("$device_id"),s={token:i,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:_({},(null==(e=this._instance.persistence)?void 0:e.get_initial_props())||{},this._instance.get_property(Ve)||{}),group_properties:this._instance.get_property(Ke),timezone:ts()};C(r)||O(r)||(s.$device_id=r),(null!=t&&t.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(s.disable_flags=!0),this.ct()&&(s.evaluation_contexts=this.vt());var n=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",o=this._instance.requestRouter.endpointFor("flags","/flags/?v=2"+n);this.nt=!0,this._instance._send_request({method:"POST",url:o,data:s,compression:this._instance.config.disable_compression?void 0:Ji.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:t=>{var e,i,r,n=!0;if(200===t.statusCode&&(this.ut||(this.$anon_distinct_id=void 0),n=!1),this.nt=!1,!s.disable_flags||this.ut){this.ht=!n;var o=[];t.error?t.error instanceof Error?o.push("AbortError"===t.error.name?ls:us):o.push(hs):200!==t.statusCode&&o.push(ds(t.statusCode)),null!=(e=t.json)&&e.errorsWhileComputingFlags&&o.push(ns);var a=!(null==(i=t.json)||null==(i=i.quotaLimited)||!i.includes(bs.FeatureFlags));if(a&&o.push(as),null==(r=this._instance.persistence)||r.register({[Qe]:o}),a)rs.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var l;if(!s.disable_flags)this.receivedFeatureFlags(null!==(l=t.json)&&void 0!==l?l:{},n);this.ut&&(this.ut=!1,this.yt())}}}})}}getFeatureFlag(t,e){var i;if(void 0===e&&(e={}),!e.fresh||this.ht){if(this.st||this.getFlags()&&this.getFlags().length>0){var r=this.getFeatureFlagResult(t,e);return null!==(i=null==r?void 0:r.variant)&&void 0!==i?i:null==r?void 0:r.enabled}rs.warn('getFeatureFlag for key "'+t+"\" failed. Feature flags didn't load in time.")}}getFeatureFlagDetails(t){return this.getFlagsWithDetails()[t]}getFeatureFlagPayload(t){var e=this.getFeatureFlagResult(t,{send_event:!1});return null==e?void 0:e.payload}getFeatureFlagResult(t,e){if(void 0===e&&(e={}),!e.fresh||this.ht)if(this.st||this.getFlags()&&this.getFlags().length>0){var i=this.getFlagVariants(),r=t in i,s=i[t],n=this.getFlagPayloads()[t],o=String(s),a=this._instance.get_property(_s)||void 0,l=this._instance.get_property(gs)||void 0,u=this._instance.get_property(Xe)||{};if((e.send_event||!("send_event"in e))&&(!(t in u)||!u[t].includes(o))){var h,d,v,c,f,p,_,g,m,y;P(u[t])?u[t].push(o):u[t]=[o],null==(h=this._instance.persistence)||h.register({[Xe]:u});var b=this.getFeatureFlagDetails(t),w=[...null!==(d=this._instance.get_property(Qe))&&void 0!==d?d:[]];O(s)&&w.push(os);var x={$feature_flag:t,$feature_flag_response:s,$feature_flag_payload:n||null,$feature_flag_request_id:a,$feature_flag_evaluated_at:l,$feature_flag_bootstrapped_response:(null==(v=this._instance.config.bootstrap)||null==(v=v.featureFlags)?void 0:v[t])||null,$feature_flag_bootstrapped_payload:(null==(c=this._instance.config.bootstrap)||null==(c=c.featureFlagPayloads)?void 0:c[t])||null,$used_bootstrap_value:!this.ht};O(null==b||null==(f=b.metadata)?void 0:f.version)||(x.$feature_flag_version=b.metadata.version);var S,E=null!==(p=null==b||null==(_=b.reason)?void 0:_.description)&&void 0!==p?p:null==b||null==(g=b.reason)?void 0:g.code;if(E&&(x.$feature_flag_reason=E),null!=b&&null!=(m=b.metadata)&&m.id&&(x.$feature_flag_id=b.metadata.id),O(null==b?void 0:b.original_variant)&&O(null==b?void 0:b.original_enabled)||(x.$feature_flag_original_response=O(b.original_variant)?b.original_enabled:b.original_variant),null!=b&&null!=(y=b.metadata)&&y.original_payload)x.$feature_flag_original_payload=null==b||null==(S=b.metadata)?void 0:S.original_payload;w.length&&(x.$feature_flag_error=w.join(",")),this._instance.capture("$feature_flag_called",x)}if(r){var k=n;if(!O(n))try{k=JSON.parse(n)}catch(t){}return{key:t,enabled:!!s,variant:"string"==typeof s?s:void 0,payload:k}}}else rs.warn('getFeatureFlagResult for key "'+t+"\" failed. Feature flags didn't load in time.")}getRemoteConfigPayload(t,e){var i=this._instance.config.token,r={distinct_id:this._instance.get_distinct_id(),token:i};this.ct()&&(r.evaluation_contexts=this.vt()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2"),data:r,compression:this._instance.config.disable_compression?void 0:Ji.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var r,s=null==(r=i.json)?void 0:r.featureFlagPayloads;e((null==s?void 0:s[t])||void 0)}})}isFeatureEnabled(t,e){if(void 0===e&&(e={}),!e.fresh||this.ht){if(this.st||this.getFlags()&&this.getFlags().length>0){var i=this.getFeatureFlag(t,e);return O(i)?void 0:!!i}rs.warn('isFeatureEnabled for key "'+t+"\" failed. Feature flags didn't load in time.")}}addFeatureFlagsHandler(t){this.featureFlagEventHandlers.push(t)}removeFeatureFlagsHandler(t){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((e=>e!==t))}receivedFeatureFlags(t,e){if(this._instance.persistence){this.st=!0;var i=this.getFlagVariants(),r=this.getFlagPayloads(),s=this.getFlagsWithDetails();!function(t,e,i,r,s){void 0===i&&(i={}),void 0===r&&(r={}),void 0===s&&(s={});var n=ys(t),o=n.flags,a=n.featureFlags,l=n.featureFlagPayloads;if(a){var u=t.requestId,h=t.evaluatedAt;if(P(a)){rs.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var d={};if(a)for(var v=0;v<a.length;v++)d[a[v]]=!0;e&&e.register({[vs]:a,[We]:d})}else{var c=a,f=l,p=o;if(t.errorsWhileComputingFlags)if(o){var g=new Set(Object.keys(o).filter((t=>{var e;return!(null!=(e=o[t])&&e.failed)})));c=_({},i,Object.fromEntries(Object.entries(c).filter((t=>{var[e]=t;return g.has(e)})))),f=_({},r,Object.fromEntries(Object.entries(f||{}).filter((t=>{var[e]=t;return g.has(e)})))),p=_({},s,Object.fromEntries(Object.entries(p||{}).filter((t=>{var[e]=t;return g.has(e)}))))}else c=_({},i,c),f=_({},r,f),p=_({},s,p);e&&e.register(_({[vs]:Object.keys(ms(c)),[We]:c||{},[fs]:f||{},[Je]:p||{}},u?{[_s]:u}:{},h?{[gs]:h}:{}))}}}(t,this._instance.persistence,i,r,s),this.xt(e)}}override(t,e){void 0===e&&(e=!1),rs.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:t,suppressWarning:e})}overrideFeatureFlags(t){if(!this._instance.__loaded||!this._instance.persistence)return rs.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(!1===t)return this._instance.persistence.unregister(cs),this._instance.persistence.unregister(ps),this.xt(),ss.info("All overrides cleared");if(t&&"object"==typeof t&&("flags"in t||"payloads"in t)){var e,i=t;if(this.rt=Boolean(null!==(e=i.suppressWarning)&&void 0!==e&&e),"flags"in i)if(!1===i.flags)this._instance.persistence.unregister(cs),ss.info("Flag overrides cleared");else if(i.flags){if(P(i.flags)){for(var r={},s=0;s<i.flags.length;s++)r[i.flags[s]]=!0;this._instance.persistence.register({[cs]:r})}else this._instance.persistence.register({[cs]:i.flags});ss.info("Flag overrides set",{flags:i.flags})}return"payloads"in i&&(!1===i.payloads?(this._instance.persistence.unregister(ps),ss.info("Payload overrides cleared")):i.payloads&&(this._instance.persistence.register({[ps]:i.payloads}),ss.info("Payload overrides set",{payloads:i.payloads}))),void this.xt()}this.xt()}onFeatureFlags(t){if(this.addFeatureFlagsHandler(t),this.st){var{flags:e,flagVariants:i}=this.$t();t(e,i)}return()=>this.removeFeatureFlagsHandler(t)}updateEarlyAccessFeatureEnrollment(t,e,i){var r,s=(this._instance.get_property(Ge)||[]).find((e=>e.flagKey===t)),n={["$feature_enrollment/"+t]:e},o={$feature_flag:t,$feature_enrollment:e,$set:n};s&&(o.$early_access_feature_name=s.name),i&&(o.$feature_enrollment_stage=i),this._instance.capture("$feature_enrollment_update",o),this.setPersonPropertiesForFlags(n,!1);var a=_({},this.getFlagVariants(),{[t]:e});null==(r=this._instance.persistence)||r.register({[vs]:Object.keys(ms(a)),[We]:a}),this.xt()}getEarlyAccessFeatures(t,e,i){void 0===e&&(e=!1);var r=this._instance.get_property(Ge),s=i?"&"+i.map((t=>"stage="+t)).join("&"):"";if(r&&!e)return t(r);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+s),method:"GET",callback:e=>{var i,r;if(e.json){var s=e.json.earlyAccessFeatures;return null==(i=this._instance.persistence)||i.unregister(Ge),null==(r=this._instance.persistence)||r.register({[Ge]:s}),t(s)}}})}$t(){var t=this.getFlags(),e=this.getFlagVariants();return{flags:t.filter((t=>e[t])),flagVariants:Object.keys(e).filter((t=>e[t])).reduce(((t,i)=>(t[i]=e[i],t)),{})}}xt(t){var{flags:e,flagVariants:i}=this.$t();this.featureFlagEventHandlers.forEach((r=>r(e,i,{errorsLoading:t})))}setPersonPropertiesForFlags(t,e){void 0===e&&(e=!0);var i=this._instance.get_property(Ve)||{};this._instance.register({[Ve]:_({},i,t)}),e&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(Ve)}setGroupPropertiesForFlags(t,e){void 0===e&&(e=!0);var i=this._instance.get_property(Ke)||{};0!==Object.keys(i).length&&Object.keys(i).forEach((e=>{i[e]=_({},i[e],t[e]),delete t[e]})),this._instance.register({[Ke]:_({},i,t)}),e&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(t){if(t){var e=this._instance.get_property(Ke)||{};this._instance.register({[Ke]:_({},e,{[t]:{}})})}else this._instance.unregister(Ke)}reset(){this.st=!1,this.nt=!1,this.ot=!1,this.ut=!1,this.ht=!1,this.$anon_distinct_id=void 0,this.bt(),this.rt=!1}}var xs=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class $s{constructor(t,e){this.R=t,this.props={},this.St=!1,this.Et=(t=>{var e="";return t.token&&(e=t.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),t.persistence_name?"ph_"+t.persistence_name:"ph_"+e+"_posthog"})(t),this.j=this.kt(t),this.load(),t.debug&&we.info("Persistence loaded",t.persistence,_({},this.props)),this.update_config(t,t,e),this.save()}isDisabled(){return!!this.Pt}kt(e){-1===xs.indexOf(e.persistence.toLowerCase())&&(we.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var i=function(e){void 0===e&&(e=[]);var i=[...xi,...e];return _({},wi,{I:function(t){try{var e={};try{e=yi.I(t)||{}}catch(t){}var i=Fe(e,JSON.parse(wi.F(t)||"{}"));return wi.T(t,i),i}catch(t){}return null},T:function(t,e,r,s,n,o){try{wi.T(t,e,void 0,void 0,o);var a={};i.forEach((t=>{e[t]&&(a[t]=e[t])})),Object.keys(a).length&&yi.T(t,a,r,s,n,o)}catch(t){wi.P(t)}},O:function(e,i){try{null==t||t.localStorage.removeItem(e),yi.O(e,i)}catch(t){wi.P(t)}}})}(e.cookie_persisted_properties||[]),r=e.persistence.toLowerCase();return"localstorage"===r&&wi.k()?wi:"localstorage+cookie"===r&&i.k()?i:"sessionstorage"===r&&ki.k()?ki:"memory"===r?Si:"cookie"===r?yi:i.k()?i:yi}properties(){var t={};return Pe(this.props,(function(e,i){if(i===We&&I(e))for(var r=Object.keys(e),n=0;n<r.length;n++)t["$feature/"+r[n]]=e[r[n]];else a=i,l=!1,(C(o=ai)?l:s&&o.indexOf===s?-1!=o.indexOf(a):(Pe(o,(function(t){if(l||(l=t===a))return Ee})),l))||(t[i]=e);var o,a,l})),t}load(){if(!this.Pt){var t=this.j.I(this.Et);t&&(this.props=Fe({},t))}}save(){this.Pt||this.j.T(this.Et,this.props,this.Ft,this.It,this.Tt,this.R.debug)}remove(){this.j.O(this.Et,!1),this.j.O(this.Et,!0)}clear(){this.remove(),this.props={}}register_once(t,e,i){if(I(t)){O(e)&&(e="None"),this.Ft=O(i)?this.Ot:i;var r=!1;if(Pe(t,((t,i)=>{this.props.hasOwnProperty(i)&&this.props[i]!==e||(this.props[i]=t,r=!0)})),r)return this.save(),!0}return!1}register(t,e){if(I(t)){this.Ft=O(e)?this.Ot:e;var i=!1;if(Pe(t,((e,r)=>{t.hasOwnProperty(r)&&this.props[r]!==e&&(this.props[r]=e,i=!0)})),i)return this.save(),!0}return!1}unregister(t){t in this.props&&(delete this.props[t],this.save())}update_campaign_params(){if(!this.St){var t=Jr(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);T(Re(t))||this.register(t),this.St=!0}}update_search_keyword(){var t;this.register((t=null==o?void 0:o.referrer)?Kr(t):{})}update_referrer_info(){var t;this.register_once({$referrer:Xr(),$referring_domain:null!=o&&o.referrer&&(null==(t=ji(o.referrer))?void 0:t.host)||"$direct"},void 0)}set_initial_person_info(){this.props[ii]||this.props[ri]||this.register_once({[si]:Qr(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var t={};Pe([ri,ii],(e=>{var i=this.props[e];i&&Pe(i,(function(e,i){t["$initial_"+w(i)]=e}))}));var e,i,r=this.props[si];if(r){var s=(e=Zr(r),i={},Pe(e,(function(t,e){i["$initial_"+w(e)]=t})),i);Fe(t,s)}return t}safe_merge(t){return Pe(this.props,(function(e,i){i in t||(t[i]=e)})),t}update_config(t,e,i){if(this.Ot=this.Ft=t.cookie_expiration,this.set_disabled(t.disable_persistence||!!i),this.set_cross_subdomain(t.cross_subdomain_cookie),this.set_secure(t.secure_cookie),t.persistence!==e.persistence||!((t,e)=>{if(t.length!==e.length)return!1;var i=[...t].sort(),r=[...e].sort();return i.every(((t,e)=>t===r[e]))})(t.cookie_persisted_properties||[],e.cookie_persisted_properties||[])){var r=this.kt(t),s=this.props;this.clear(),this.j=r,this.props=s,this.save()}}set_disabled(t){this.Pt=t,this.Pt?this.remove():this.save()}set_cross_subdomain(t){t!==this.It&&(this.It=t,this.remove(),this.save())}set_secure(t){t!==this.Tt&&(this.Tt=t,this.remove(),this.save())}set_event_timer(t,e){var i=this.props[ze]||{};i[t]=e,this.props[ze]=i,this.save()}remove_event_timer(t){var e=(this.props[ze]||{})[t];return O(e)||(delete this.props[ze][t],this.save()),e}get_property(t){return this.props[t]}set_property(t,e){this.props[t]=e,this.save()}}var Ss=function(t){return t.Activation="events",t.Cancellation="cancelEvents",t}({}),Es=function(t){return t.Button="button",t.Tab="tab",t.Selector="selector",t}({}),ks=function(t){return t.TopLeft="top_left",t.TopRight="top_right",t.TopCenter="top_center",t.MiddleLeft="middle_left",t.MiddleRight="middle_right",t.MiddleCenter="middle_center",t.Left="left",t.Center="center",t.Right="right",t.NextToTrigger="next_to_trigger",t}({}),Ps=function(t){return t.Top="top",t.Left="left",t.Right="right",t.Bottom="bottom",t}({}),Fs=function(t){return t.Popover="popover",t.API="api",t.Widget="widget",t.ExternalSurvey="external_survey",t}({}),Is=function(t){return t.Open="open",t.MultipleChoice="multiple_choice",t.SingleChoice="single_choice",t.Rating="rating",t.Link="link",t}({}),Ts=function(t){return t.NextQuestion="next_question",t.End="end",t.ResponseBased="response_based",t.SpecificQuestion="specific_question",t}({}),Os=function(t){return t.Once="once",t.Recurring="recurring",t.Always="always",t}({}),Rs=function(t){return t.SHOWN="survey shown",t.DISMISSED="survey dismissed",t.SENT="survey sent",t.ABANDONED="survey abandoned",t}({}),Ms=function(t){return t.SURVEY_ID="$survey_id",t.SURVEY_NAME="$survey_name",t.SURVEY_RESPONSE="$survey_response",t.SURVEY_ITERATION="$survey_iteration",t.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",t.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",t.SURVEY_SUBMISSION_ID="$survey_submission_id",t.SURVEY_QUESTIONS="$survey_questions",t.SURVEY_COMPLETED="$survey_completed",t.PRODUCT_TOUR_ID="$product_tour_id",t.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",t}({}),Cs=function(t){return t.Popover="popover",t.Inline="inline",t}({}),js=xe("[Surveys]");var Ds="seenSurvey_",As=(t,e)=>{var i="$survey_"+e+"/"+t.id;return t.current_iteration&&t.current_iteration>0&&(i="$survey_"+e+"/"+t.id+"/"+t.current_iteration),i},Ns=t=>((t,e)=>{var i=""+t+e.id;return e.current_iteration&&e.current_iteration>0&&(i=""+t+e.id+"_"+e.current_iteration),i})(Ds,t),Us=[Fs.Popover,Fs.Widget,Fs.API],Ls={ignoreConditions:!1,ignoreDelay:!1,displayType:Cs.Popover};class zs{constructor(){this.Rt={},this.Rt={}}on(t,e){return this.Rt[t]||(this.Rt[t]=[]),this.Rt[t].push(e),()=>{this.Rt[t]=this.Rt[t].filter((t=>t!==e))}}emit(t,e){for(var i of this.Rt[t]||[])i(e);for(var r of this.Rt["*"]||[])r(t,e)}}function Bs(t,e,i){if(j(t))return!1;switch(i){case"exact":return t===e;case"contains":var r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(r,"i").test(t);case"regex":try{return new RegExp(e).test(t)}catch(t){return!1}default:return!1}}class Hs{constructor(t){this.Mt=new zs,this.Ct=(t,e)=>this.jt(t,e)&&this.Dt(t,e)&&this.At(t,e)&&this.Nt(t,e),this.jt=(t,e)=>null==e||!e.event||(null==t?void 0:t.event)===(null==e?void 0:e.event),this._instance=t,this.Ut=new Set,this.Lt=new Set}init(){var t;if(!O(null==(t=this._instance)?void 0:t._addCaptureHook)){var e;null==(e=this._instance)||e._addCaptureHook(((t,e)=>{this.on(t,e)}))}}register(t){var e,i;if(!O(null==(e=this._instance)?void 0:e._addCaptureHook)&&(t.forEach((t=>{var e,i;null==(e=this.Lt)||e.add(t),null==(i=t.steps)||i.forEach((t=>{var e;null==(e=this.Ut)||e.add((null==t?void 0:t.event)||"")}))})),null!=(i=this._instance)&&i.autocapture)){var r,s=new Set;t.forEach((t=>{var e;null==(e=t.steps)||e.forEach((t=>{null!=t&&t.selector&&s.add(null==t?void 0:t.selector)}))})),null==(r=this._instance)||r.autocapture.setElementSelectors(s)}}on(t,e){var i;null!=e&&0!=t.length&&(this.Ut.has(t)||this.Ut.has(null==e?void 0:e.event))&&this.Lt&&(null==(i=this.Lt)?void 0:i.size)>0&&this.Lt.forEach((t=>{this.zt(e,t)&&this.Mt.emit("actionCaptured",t.name)}))}Bt(t){this.onAction("actionCaptured",(e=>t(e)))}zt(t,e){if(null==(null==e?void 0:e.steps))return!1;for(var i of e.steps)if(this.Ct(t,i))return!0;return!1}onAction(t,e){return this.Mt.on(t,e)}Dt(t,e){if(null!=e&&e.url){var i,r=null==t||null==(i=t.properties)?void 0:i.$current_url;if(!r||"string"!=typeof r)return!1;if(!Bs(r,e.url,e.url_matching||"contains"))return!1}return!0}At(t,e){return!!this.Ht(t,e)&&(!!this.qt(t,e)&&!!this.Wt(t,e))}Ht(t,e){var i;if(null==e||!e.href)return!0;var r=this.Gt(t);if(r.length>0)return r.some((t=>Bs(t.href,e.href,e.href_matching||"exact")));var s,n=(null==t||null==(i=t.properties)?void 0:i.$elements_chain)||"";return!!n&&Bs((s=n.match(/(?::|")href="(.*?)"/))?s[1]:"",e.href,e.href_matching||"exact")}qt(t,e){var i;if(null==e||!e.text)return!0;var r=this.Gt(t);if(r.length>0)return r.some((t=>Bs(t.text,e.text,e.text_matching||"exact")||Bs(t.$el_text,e.text,e.text_matching||"exact")));var s,n,o,a=(null==t||null==(i=t.properties)?void 0:i.$elements_chain)||"";return!!a&&(s=function(t){for(var e,i=[],r=/(?::|")text="(.*?)"/g;!j(e=r.exec(t));)i.includes(e[1])||i.push(e[1]);return i}(a),n=e.text,o=e.text_matching||"exact",s.some((t=>Bs(t,n,o))))}Wt(t,e){var i,r;if(null==e||!e.selector)return!0;var s=null==t||null==(i=t.properties)?void 0:i.$element_selectors;if(null!=s&&s.includes(e.selector))return!0;var n=(null==t||null==(r=t.properties)?void 0:r.$elements_chain)||"";if(e.selector_regex&&n)try{return new RegExp(e.selector_regex).test(n)}catch(t){return!1}return!1}Gt(t){var e;return null==(null==t||null==(e=t.properties)?void 0:e.$elements)?[]:null==t?void 0:t.properties.$elements}Nt(t,e){return null==e||!e.properties||0===e.properties.length||Ur(e.properties.reduce(((t,e)=>{var i=P(e.value)?e.value.map(String):null!=e.value?[String(e.value)]:[];return t[e.key]={values:i,operator:e.operator||"exact"},t}),{}),null==t?void 0:t.properties)}}class qs{constructor(t){this._instance=t,this.Jt=new Map,this.Vt=new Map,this.Kt=new Map}Yt(t,e){return!!t&&Ur(t.propertyFilters,null==e?void 0:e.properties)}Xt(t,e){var i=new Map;return t.forEach((t=>{var r;null==(r=t.conditions)||null==(r=r[e])||null==(r=r.values)||r.forEach((e=>{if(null!=e&&e.name){var r=i.get(e.name)||[];r.push(t.id),i.set(e.name,r)}}))})),i}Qt(t,e,i){var r=(i===Ss.Activation?this.Jt:this.Vt).get(t),s=[];return this.Zt((t=>{s=t.filter((t=>null==r?void 0:r.includes(t.id)))})),s.filter((r=>{var s,n=null==(s=r.conditions)||null==(s=s[i])||null==(s=s.values)?void 0:s.find((e=>e.name===t));return this.Yt(n,e)}))}register(t){var e;O(null==(e=this._instance)?void 0:e._addCaptureHook)||(this.te(t),this.ee(t))}ee(t){var e=t.filter((t=>{var e,i;return(null==(e=t.conditions)?void 0:e.actions)&&(null==(i=t.conditions)||null==(i=i.actions)||null==(i=i.values)?void 0:i.length)>0}));if(0!==e.length){if(null==this.ie){this.ie=new Hs(this._instance),this.ie.init();this.ie.Bt((t=>{this.onAction(t)}))}e.forEach((t=>{var e,i,r,s,n;t.conditions&&null!=(e=t.conditions)&&e.actions&&null!=(i=t.conditions)&&null!=(i=i.actions)&&i.values&&(null==(r=t.conditions)||null==(r=r.actions)||null==(r=r.values)?void 0:r.length)>0&&(null==(s=this.ie)||s.register(t.conditions.actions.values),null==(n=t.conditions)||null==(n=n.actions)||null==(n=n.values)||n.forEach((e=>{if(e&&e.name){var i=this.Kt.get(e.name);i&&i.push(t.id),this.Kt.set(e.name,i||[t.id])}})))}))}}te(t){var e,i=t.filter((t=>{var e,i;return(null==(e=t.conditions)?void 0:e.events)&&(null==(i=t.conditions)||null==(i=i.events)||null==(i=i.values)?void 0:i.length)>0})),r=t.filter((t=>{var e,i;return(null==(e=t.conditions)?void 0:e.cancelEvents)&&(null==(i=t.conditions)||null==(i=i.cancelEvents)||null==(i=i.values)?void 0:i.length)>0}));if(0!==i.length||0!==r.length){null==(e=this._instance)||e._addCaptureHook(((t,e)=>{this.onEvent(t,e)})),this.Jt=this.Xt(t,Ss.Activation),this.Vt=this.Xt(t,Ss.Cancellation)}}onEvent(t,e){var i,r=this.re(),s=this.se(),n=this.ne(),o=(null==(i=this._instance)||null==(i=i.persistence)?void 0:i.props[s])||[];if(n===t&&e&&o.length>0){var a,l;r.info("event matched, removing item from activated items",{event:t,eventPayload:e,existingActivatedItems:o});var u=(null==e||null==(a=e.properties)?void 0:a.$survey_id)||(null==e||null==(l=e.properties)?void 0:l.$product_tour_id);if(u){var h=o.indexOf(u);h>=0&&(o.splice(h,1),this.oe(o))}}else{if(this.Vt.has(t)){var d=this.Qt(t,e,Ss.Cancellation);d.length>0&&(r.info("cancel event matched, cancelling items",{event:t,itemsToCancel:d.map((t=>t.id))}),d.forEach((t=>{var e=o.indexOf(t.id);e>=0&&o.splice(e,1),this.ae(t.id)})),this.oe(o))}if(this.Jt.has(t)){r.info("event name matched",{event:t,eventPayload:e,items:this.Jt.get(t)});var v=this.Qt(t,e,Ss.Activation);this.oe(o.concat(v.map((t=>t.id))||[]))}}}onAction(t){var e,i=this.se(),r=(null==(e=this._instance)||null==(e=e.persistence)?void 0:e.props[i])||[];this.Kt.has(t)&&this.oe(r.concat(this.Kt.get(t)||[]))}oe(t){var e,i=this.re(),r=this.se(),s=[...new Set(t)].filter((t=>!this.le(t)));i.info("updating activated items",{activatedItems:s}),null==(e=this._instance)||null==(e=e.persistence)||e.register({[r]:s})}getActivatedIds(){var t,e=this.se(),i=null==(t=this._instance)||null==(t=t.persistence)?void 0:t.props[e];return i||[]}getEventToItemsMap(){return this.Jt}ue(){return this.ie}}class Ws extends qs{constructor(t){super(t)}se(){return"$surveys_activated"}ne(){return Rs.SHOWN}Zt(t){var e;null==(e=this._instance)||e.getSurveys(t)}ae(t){var e;null==(e=this._instance)||e.cancelPendingSurvey(t)}re(){return js}le(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class Gs{constructor(t){this.he=void 0,this._surveyManager=null,this.de=!1,this.ve=[],this.ce=null,this._instance=t,this._surveyEventReceiver=null}onRemoteConfig(t){if(!this._instance.config.disable_surveys){var e=t.surveys;if(j(e))return js.warn("Flags not loaded yet. Not loading surveys.");var i=P(e);this.he=i?e.length>0:e,js.info("flags response received, isSurveysEnabled: "+this.he),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var t=[],e=0;e<localStorage.length;e++){var i=localStorage.key(e);(null!=i&&i.startsWith(Ds)||null!=i&&i.startsWith("inProgressSurvey_"))&&t.push(i)}t.forEach((t=>localStorage.removeItem(t)))}loadIfEnabled(){if(!this._surveyManager)if(this.de)js.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)js.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())js.info("Not loading surveys in cookieless mode without consent.");else{var t=null==v?void 0:v.__PosthogExtensions__;if(t){if(!O(this.he)||this._instance.config.advanced_enable_surveys){var e=this.he||this._instance.config.advanced_enable_surveys;this.de=!0;try{var i=t.generateSurveys;if(i)return void this.fe(i,e);var r=t.loadExternalDependency;if(!r)return void this.pe("PostHog loadExternalDependency extension not found.");r(this._instance,"surveys",(i=>{i||!t.generateSurveys?this.pe("Could not load surveys script",i):this.fe(t.generateSurveys,e)}))}catch(t){throw this.pe("Error initializing surveys",t),t}finally{this.de=!1}}}else js.error("PostHog Extensions not found.")}}fe(t,e){this._surveyManager=t(this._instance,e),this._surveyEventReceiver=new Ws(this._instance),js.info("Surveys loaded successfully"),this._e({isLoaded:!0})}pe(t,e){js.error(t,e),this._e({isLoaded:!1,error:t})}onSurveysLoaded(t){return this.ve.push(t),this._surveyManager&&this._e({isLoaded:!0}),()=>{this.ve=this.ve.filter((e=>e!==t))}}getSurveys(t,e){if(void 0===e&&(e=!1),this._instance.config.disable_surveys)return js.info("Disabled. Not loading surveys."),t([]);var i,r=this._instance.get_property(Ye);if(r&&!e)return t(r,{isLoaded:!0});"undefined"!=typeof Promise&&this.ce?this.ce.then((e=>{var{surveys:i,context:r}=e;return t(i,r)})):("undefined"!=typeof Promise&&(this.ce=new Promise((t=>{i=t}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:e=>{var r;this.ce=null;var s=e.statusCode;if(200!==s||!e.json){var n="Surveys API could not be loaded, status: "+s;js.error(n);var o={isLoaded:!1,error:n};return t([],o),void(null==i||i({surveys:[],context:o}))}var a,l=e.json.surveys||[],u=l.filter((t=>function(t){return!(!t.start_date||t.end_date)}(t)&&(function(t){var e;return!(null==(e=t.conditions)||null==(e=e.events)||null==(e=e.values)||!e.length)}(t)||function(t){var e;return!(null==(e=t.conditions)||null==(e=e.actions)||null==(e=e.values)||!e.length)}(t))));u.length>0&&(null==(a=this._surveyEventReceiver)||a.register(u));null==(r=this._instance.persistence)||r.register({[Ye]:l});var h={isLoaded:!0};t(l,h),null==i||i({surveys:l,context:h})}}))}_e(t){for(var e of this.ve)try{if(!t.isLoaded)return e([],t);this.getSurveys(e)}catch(t){js.error("Error in survey callback",t)}}getActiveMatchingSurveys(t,e){if(void 0===e&&(e=!1),!j(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(t,e);js.warn("init was not called")}ge(t){var e=null;return this.getSurveys((i=>{var r;e=null!==(r=i.find((e=>e.id===t)))&&void 0!==r?r:null})),e}me(t){if(j(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var e="string"==typeof t?this.ge(t):t;return e?this._surveyManager.checkSurveyEligibility(e):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(t){if(j(this._surveyManager))return js.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var e=this.me(t);return{visible:e.eligible,disabledReason:e.reason}}canRenderSurveyAsync(t,e){return j(this._surveyManager)?(js.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((i=>{this.getSurveys((e=>{var r,s=null!==(r=e.find((e=>e.id===t)))&&void 0!==r?r:null;if(s){var n=this.me(s);i({visible:n.eligible,disabledReason:n.reason})}else i({visible:!1,disabledReason:"Survey not found"})}),e)}))}renderSurvey(t,e,i){var r;if(j(this._surveyManager))js.warn("init was not called");else{var s="string"==typeof t?this.ge(t):t;if(null!=s&&s.id)if(Us.includes(s.type)){var n=null==o?void 0:o.querySelector(e);if(n)return null!=(r=s.appearance)&&r.surveyPopupDelaySeconds?(js.info("Rendering survey "+s.id+" with delay of "+s.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var t,e;js.info("Rendering survey "+s.id+" with delay of "+(null==(t=s.appearance)?void 0:t.surveyPopupDelaySeconds)+" seconds"),null==(e=this._surveyManager)||e.renderSurvey(s,n,i),js.info("Survey "+s.id+" rendered")}),1e3*s.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(s,n,i);js.warn("Survey element not found")}else js.warn("Surveys of type "+s.type+" cannot be rendered in the app");else js.warn("Survey not found")}}displaySurvey(t,e){var i;if(j(this._surveyManager))js.warn("init was not called");else{var r=this.ge(t);if(r){var s=r;if(null!=(i=r.appearance)&&i.surveyPopupDelaySeconds&&e.ignoreDelay&&(s=_({},r,{appearance:_({},r.appearance,{surveyPopupDelaySeconds:0})})),e.displayType!==Cs.Popover&&e.initialResponses&&js.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),!1===e.ignoreConditions){var n=this.canRenderSurvey(r);if(!n.visible)return void js.warn("Survey is not eligible to be displayed: ",n.disabledReason)}e.displayType!==Cs.Inline?this._surveyManager.handlePopoverSurvey(s,e):this.renderSurvey(s,e.selector,e.properties)}else js.warn("Survey not found")}}cancelPendingSurvey(t){j(this._surveyManager)?js.warn("init was not called"):this._surveyManager.cancelSurvey(t)}handlePageUnload(){var t;null==(t=this._surveyManager)||t.handlePageUnload()}}var Js=xe("[Conversations]");class Vs{constructor(t){this.ye=void 0,this._conversationsManager=null,this.be=!1,this.we=null,this._instance=t}onRemoteConfig(t){if(!this._instance.config.disable_conversations){var e=t.conversations;j(e)||(N(e)?this.ye=e:(this.ye=e.enabled,this.we=e),this.loadIfEnabled())}}reset(){var t;null==(t=this._conversationsManager)||t.reset(),this._conversationsManager=null,this.ye=void 0,this.we=null}loadIfEnabled(){if(!(this._conversationsManager||this.be||this._instance.config.disable_conversations||Ne(this._instance.config)||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var t=null==v?void 0:v.__PosthogExtensions__;if(t&&!O(this.ye)&&this.ye)if(this.we&&this.we.token){this.be=!0;try{var e=t.initConversations;if(e)return this.xe(e),void(this.be=!1);var i=t.loadExternalDependency;if(!i)return void this.$e("PostHog loadExternalDependency extension not found.");i(this._instance,"conversations",(e=>{e||!t.initConversations?this.$e("Could not load conversations script",e):this.xe(t.initConversations),this.be=!1}))}catch(t){this.$e("Error initializing conversations",t),this.be=!1}}else Js.error("Conversations enabled but missing token in remote config.")}}xe(t){if(this.we)try{this._conversationsManager=t(this.we,this._instance),Js.info("Conversations loaded successfully")}catch(t){this.$e("Error completing conversations initialization",t)}else Js.error("Cannot complete initialization: remote config is null")}$e(t,e){Js.error(t,e),this._conversationsManager=null,this.be=!1}show(){this._conversationsManager?this._conversationsManager.show():Js.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return!0===this.ye&&!C(this._conversationsManager)}isVisible(){var t,e;return null!==(t=null==(e=this._conversationsManager)?void 0:e.isVisible())&&void 0!==t&&t}sendMessage(t,e,i){var r=this;return p((function*(){return r._conversationsManager?r._conversationsManager.sendMessage(t,e,i):(Js.warn("Conversations not available yet."),null)}))()}getMessages(t,e){var i=this;return p((function*(){return i._conversationsManager?i._conversationsManager.getMessages(t,e):(Js.warn("Conversations not available yet."),null)}))()}markAsRead(t){var e=this;return p((function*(){return e._conversationsManager?e._conversationsManager.markAsRead(t):(Js.warn("Conversations not available yet."),null)}))()}getTickets(t){var e=this;return p((function*(){return e._conversationsManager?e._conversationsManager.getTickets(t):(Js.warn("Conversations not available yet."),null)}))()}requestRestoreLink(t){var e=this;return p((function*(){return e._conversationsManager?e._conversationsManager.requestRestoreLink(t):(Js.warn("Conversations not available yet."),null)}))()}restoreFromToken(t){var e=this;return p((function*(){return e._conversationsManager?e._conversationsManager.restoreFromToken(t):(Js.warn("Conversations not available yet."),null)}))()}restoreFromUrlToken(){var t=this;return p((function*(){return t._conversationsManager?t._conversationsManager.restoreFromUrlToken():(Js.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var t,e;return null!==(t=null==(e=this._conversationsManager)?void 0:e.getCurrentTicketId())&&void 0!==t?t:null}getWidgetSessionId(){var t,e;return null!==(t=null==(e=this._conversationsManager)?void 0:e.getWidgetSessionId())&&void 0!==t?t:null}}class Ks{constructor(t){var e;this.Se=!1,this.Ee=!1,this._instance=t,this._instance&&null!=(e=this._instance.config.logs)&&e.captureConsoleLogs&&(this.Se=!0)}onRemoteConfig(t){var e,i=null==(e=t.logs)?void 0:e.captureConsoleLogs;!j(i)&&i&&(this.Se=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Se&&!this.Ee){var t=xe("[logs]"),e=null==v?void 0:v.__PosthogExtensions__;if(e){var i=e.loadExternalDependency;i?i(this._instance,"logs",(i=>{var r;i||null==(r=e.logs)||!r.initializeLogs?t.error("Could not load logs script",i):(e.logs.initializeLogs(this._instance),this.Ee=!0)})):t.error("PostHog loadExternalDependency extension not found.")}else t.error("PostHog Extensions not found.")}}}var Ys=xe("[RateLimiter]");class Xs{constructor(t){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var e=t.text;if(e&&e.length)try{(JSON.parse(e).quota_limited||[]).forEach((t=>{Ys.info((t||"events")+" is quota limited."),this.serverLimits[t]=(new Date).getTime()+6e4}))}catch(t){return void Ys.warn('could not rate limit - continuing. Error: "'+(null==t?void 0:t.message)+'"',{text:e})}},this.instance=t,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var t;return(null==(t=this.instance.config.rate_limiting)?void 0:t.events_per_second)||10}get captureEventsBurstLimit(){var t;return Math.max((null==(t=this.instance.config.rate_limiting)?void 0:t.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(t){var e,i,r;void 0===t&&(t=!1);var{captureEventsBurstLimit:s,captureEventsPerSecond:n}=this,o=(new Date).getTime(),a=null!==(e=null==(i=this.instance.persistence)?void 0:i.get_property(ei))&&void 0!==e?e:{tokens:s,last:o};a.tokens+=(o-a.last)/1e3*n,a.last=o,a.tokens>s&&(a.tokens=s);var l=a.tokens<1;return l||t||(a.tokens=Math.max(0,a.tokens-1)),!l||this.lastEventRateLimited||t||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+n+" events per second and "+s+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=l,null==(r=this.instance.persistence)||r.set_property(ei,a),{isRateLimited:l,remainingTokens:a.tokens}}isServerRateLimited(t){var e=this.serverLimits[t||"events"]||!1;return!1!==e&&(new Date).getTime()<e}}var Qs=xe("[RemoteConfig]");class Zs{constructor(t){this._instance=t}get remoteConfig(){var t;return null==(t=v._POSTHOG_REMOTE_CONFIG)||null==(t=t[this._instance.config.token])?void 0:t.config}ke(t){var e,i;null!=(e=v.__PosthogExtensions__)&&e.loadExternalDependency?null==(i=v.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,"remote-config",(()=>t(this.remoteConfig))):t()}Pe(t){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:e=>{t(e.json)}})}load(){try{if(this.remoteConfig)return Qs.info("Using preloaded remote config",this.remoteConfig),this.Fe(this.remoteConfig),void this.Ie();if(this._instance.wt())return void Qs.warn("Remote config is disabled. Falling back to local config.");this.ke((t=>{if(!t)return Qs.info("No config found after loading remote JS config. Falling back to JSON."),void this.Pe((t=>{this.Fe(t),this.Ie()}));this.Fe(t),this.Ie()}))}catch(t){Qs.error("Error loading remote config",t)}}stop(){this.Te&&(clearInterval(this.Te),this.Te=void 0)}refresh(){this._instance.wt()||"hidden"===(null==o?void 0:o.visibilityState)||this._instance.featureFlags.reloadFeatureFlags()}Ie(){this.Te||(this.Te=setInterval((()=>{this.refresh()}),3e5))}Fe(t){t||Qs.error("Failed to fetch remote config from PostHog."),this._instance.Fe(null!=t?t:{}),!1!==(null==t?void 0:t.hasFeatureFlags)&&(this._instance.config.advanced_disable_feature_flags_on_first_load||this._instance.featureFlags.ensureFlagsLoaded())}}var tn=3e3;class en{constructor(t,e){this.Oe=!0,this.Re=[],this.Me=J((null==e?void 0:e.flush_interval_ms)||tn,250,5e3,we.createLogger("flush interval"),tn),this.Ce=t}enqueue(t){this.Re.push(t),this.je||this.De()}unload(){this.Ae();var t=this.Re.length>0?this.Ne():{},e=Object.values(t);[...e.filter((t=>0===t.url.indexOf("/e"))),...e.filter((t=>0!==t.url.indexOf("/e")))].map((t=>{this.Ce(_({},t,{transport:"sendBeacon"}))}))}enable(){this.Oe=!1,this.De()}De(){var t=this;this.Oe||(this.je=setTimeout((()=>{if(this.Ae(),this.Re.length>0){var e=this.Ne(),i=function(){var i=e[r],s=(new Date).getTime();i.data&&P(i.data)&&Pe(i.data,(t=>{t.offset=Math.abs(t.timestamp-s),delete t.timestamp})),t.Ce(i)};for(var r in e)i()}}),this.Me))}Ae(){clearTimeout(this.je),this.je=void 0}Ne(){var t={};return Pe(this.Re,(e=>{var i,r=e,s=(r?r.batchKey:null)||r.url;O(t[s])&&(t[s]=_({},r,{data:[]})),null==(i=t[s].data)||i.push(r.data)})),this.Re=[],t}}var rn=["retriesPerformedSoFar"];class sn{constructor(e){this.Ue=!1,this.Le=3e3,this.Re=[],this._instance=e,this.Re=[],this.ze=!0,!O(t)&&"onLine"in t.navigator&&(this.ze=t.navigator.onLine,this.Be=()=>{this.ze=!0,this.He()},this.qe=()=>{this.ze=!1},Ae(t,"online",this.Be),Ae(t,"offline",this.qe))}get length(){return this.Re.length}retriableRequest(t){var{retriesPerformedSoFar:e}=t,i=function(t,e){if(null==t)return{};var i={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;i[r]=t[r]}return i}(t,rn);A(e)&&(i.url=Or(i.url,{retry_count:e})),this._instance._send_request(_({},i,{callback:t=>{200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=e?e:0)<10?this.We(_({retriesPerformedSoFar:e},i)):null==i.callback||i.callback(t)}}))}We(t){var e=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=e+1;var i=function(t){var e=3e3*Math.pow(2,t),i=e/2,r=Math.min(18e5,e),s=(Math.random()-.5)*(r-i);return Math.ceil(r+s)}(e),r=Date.now()+i;this.Re.push({retryAt:r,requestOptions:t});var s="Enqueued failed request for retry in "+i;navigator.onLine||(s+=" (Browser is offline)"),we.warn(s),this.Ue||(this.Ue=!0,this.Ge())}Ge(){if(this.Je&&clearTimeout(this.Je),0===this.Re.length)return this.Ue=!1,void(this.Je=void 0);this.Je=setTimeout((()=>{this.ze&&this.Re.length>0&&this.He(),this.Ge()}),this.Le)}He(){var t=Date.now(),e=[],i=this.Re.filter((i=>i.retryAt<t||(e.push(i),!1)));if(this.Re=e,i.length>0)for(var{requestOptions:r}of i)this.retriableRequest(r)}unload(){for(var{requestOptions:e}of(this.Je&&(clearTimeout(this.Je),this.Je=void 0),this.Ue=!1,O(t)||(this.Be&&(t.removeEventListener("online",this.Be),this.Be=void 0),this.qe&&(t.removeEventListener("offline",this.qe),this.qe=void 0)),this.Re))try{this._instance._send_request(_({},e,{transport:"sendBeacon"}))}catch(t){we.error(t)}this.Re=[]}}class nn{constructor(t){this.Ve=()=>{var t,e,i,r;this.Ke||(this.Ke={});var s=this.scrollElement(),n=this.scrollY(),o=s?Math.max(0,s.scrollHeight-s.clientHeight):0,a=n+((null==s?void 0:s.clientHeight)||0),l=(null==s?void 0:s.scrollHeight)||0;this.Ke.lastScrollY=Math.ceil(n),this.Ke.maxScrollY=Math.max(n,null!==(t=this.Ke.maxScrollY)&&void 0!==t?t:0),this.Ke.maxScrollHeight=Math.max(o,null!==(e=this.Ke.maxScrollHeight)&&void 0!==e?e:0),this.Ke.lastContentY=a,this.Ke.maxContentY=Math.max(a,null!==(i=this.Ke.maxContentY)&&void 0!==i?i:0),this.Ke.maxContentHeight=Math.max(l,null!==(r=this.Ke.maxContentHeight)&&void 0!==r?r:0)},this._instance=t}getContext(){return this.Ke}resetContext(){var t=this.Ke;return setTimeout(this.Ve,0),t}startMeasuringScrollPosition(){Ae(t,"scroll",this.Ve,{capture:!0}),Ae(t,"scrollend",this.Ve,{capture:!0}),Ae(t,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return null==t?void 0:t.document.documentElement;var e=P(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var i of e){var r=null==t?void 0:t.document.querySelector(i);if(r)return r}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return t&&(t.scrollY||t.pageYOffset||t.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return t&&(t.scrollX||t.pageXOffset||t.document.documentElement.scrollLeft)||0}}var on=t=>Qr(null==t?void 0:t.config.mask_personal_data_properties,null==t?void 0:t.config.custom_personal_data_properties);class an{constructor(t,e,i,r){this.Ye=t=>{var e=this.Xe();if(!e||e.sessionId!==t){var i={sessionId:t,props:this.Qe(this._instance)};this.Ze.register({[ti]:i})}},this._instance=t,this.ti=e,this.Ze=i,this.Qe=r||on,this.ti.onSessionId(this.Ye)}Xe(){return this.Ze.props[ti]}getSetOnceProps(){var t,e=null==(t=this.Xe())?void 0:t.props;return e?"r"in e?Zr(e):{$referring_domain:e.referringDomain,$pathname:e.initialPathName,utm_source:e.utm_source,utm_campaign:e.utm_campaign,utm_medium:e.utm_medium,utm_content:e.utm_content,utm_term:e.utm_term}:{}}getSessionProps(){var t={};return Pe(Re(this.getSetOnceProps()),((e,i)=>{"$current_url"===i&&(i="url"),t["$session_entry_"+w(i)]=e})),t}}var ln=xe("[SessionId]");class un{on(t,e){return this.ei.on(t,e)}constructor(t,e,i){var r;if(this.ii=[],this.ri=void 0,this.ei=new zs,this.si=(t,e)=>!(!A(t)||!A(e))&&Math.abs(t-e)>this.sessionTimeoutMs,!t.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if("always"===t.config.cookieless_mode)throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=t.config,this.Ze=t.persistence,this.ni=void 0,this.oi=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ai=e||fi,this.li=i||fi;var s=this.R.persistence_name||this.R.token,n=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*J(n,60,36e3,ln.createLogger("session_idle_timeout_seconds"),1800),t.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ui(),this.hi="ph_"+s+"_window_id",this.di="ph_"+s+"_primary_window_exists",this.vi()){var o=ki.I(this.hi),a=ki.I(this.di);o&&!a?this.ni=o:ki.O(this.hi),ki.T(this.di,!0)}if(null!=(r=this.R.bootstrap)&&r.sessionID)try{var l=(t=>{var e=t.replace(/-/g,"");if(32!==e.length)throw new Error("Not a valid UUID");if("7"!==e[12])throw new Error("Not a UUIDv7");return parseInt(e.substring(0,12),16)})(this.R.bootstrap.sessionID);this.ci(this.R.bootstrap.sessionID,(new Date).getTime(),l)}catch(t){ln.error("Invalid sessionID in bootstrap",t)}this.fi()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(t){return O(this.ii)&&(this.ii=[]),this.ii.push(t),this.oi&&t(this.oi,this.ni),()=>{this.ii=this.ii.filter((e=>e!==t))}}vi(){return"memory"!==this.R.persistence&&!this.Ze.Pt&&ki.k()}pi(t){t!==this.ni&&(this.ni=t,this.vi()&&ki.T(this.hi,t))}gi(){return this.ni?this.ni:this.vi()?ki.I(this.hi):null}ci(t,e,i){t===this.oi&&e===this._sessionActivityTimestamp&&i===this._sessionStartTimestamp||(this._sessionStartTimestamp=i,this._sessionActivityTimestamp=e,this.oi=t,this.Ze.register({[qe]:[e,t,i]}))}mi(){var t=this.Ze.props[qe];return P(t)&&2===t.length&&t.push(t[0]),t||[0,null,0]}resetSessionId(){this.ci(null,null,null)}destroy(){clearTimeout(this.yi),this.yi=void 0,this.ri&&t&&(t.removeEventListener("beforeunload",this.ri,{capture:!1}),this.ri=void 0),this.ii=[]}fi(){this.ri=()=>{this.vi()&&ki.O(this.di)},Ae(t,"beforeunload",this.ri,{capture:!1})}checkAndGetSessionAndWindowId(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=null),"always"===this.R.cookieless_mode)throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var i=e||(new Date).getTime(),[r,s,n]=this.mi(),o=this.gi(),a=A(n)&&Math.abs(i-n)>864e5,l=!1,u=!s,h=!u&&!t&&this.si(i,r);u||h||a?(s=this.ai(),o=this.li(),ln.info("new session ID generated",{sessionId:s,windowId:o,changeReason:{noSessionId:u,activityTimeout:h,sessionPastMaximumLength:a}}),n=i,l=!0):o||(o=this.li(),l=!0);var d=!!A(r)&&t&&!a?r:i,v=!A(n)?(new Date).getTime():n;return this.pi(o),this.ci(s,d,v),t||this.ui(),l&&this.ii.forEach((t=>t(s,o,l?{noSessionId:u,activityTimeout:h,sessionPastMaximumLength:a}:void 0))),{sessionId:s,windowId:o,sessionStartTimestamp:v,changeReason:l?{noSessionId:u,activityTimeout:h,sessionPastMaximumLength:a}:void 0,lastActivityTimestamp:r}}ui(){clearTimeout(this.yi),this.yi=setTimeout((()=>{var[t]=this.mi();if(this.si((new Date).getTime(),t)){var e=this.oi;this.resetSessionId(),this.ei.emit("forcedIdleReset",{idleSessionId:e})}}),1.1*this.sessionTimeoutMs)}}var hn=function(t,e){if(!t)return!1;var i=t.userAgent;if(i&&y(i,e))return!0;try{var r=null==t?void 0:t.userAgentData;if(null!=r&&r.brands&&r.brands.some((t=>y(null==t?void 0:t.brand,e))))return!0}catch(t){}return!!t.webdriver},dn=function(t){return t.US="us",t.EU="eu",t.CUSTOM="custom",t}({}),vn="i.posthog.com";class cn{constructor(t){this.bi={},this.instance=t}get apiHost(){var t=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===t?"https://us.i.posthog.com":t}get flagsApiHost(){var t=this.instance.config.flags_api_host;return t?t.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var t,e=null==(t=this.instance.config.ui_host)?void 0:t.replace(/\/$/,"");return e||(e=this.apiHost.replace("."+vn,".posthog.com")),"https://app.posthog.com"===e?"https://us.posthog.com":e}get region(){return this.bi[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.bi[this.apiHost]=dn.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.bi[this.apiHost]=dn.EU:this.bi[this.apiHost]=dn.CUSTOM),this.bi[this.apiHost]}endpointFor(t,e){if(void 0===e&&(e=""),e&&(e="/"===e[0]?e:"/"+e),"ui"===t)return this.uiHost+e;if("flags"===t)return this.flagsApiHost+e;if(this.region===dn.CUSTOM)return this.apiHost+e;var i=vn+e;switch(t){case"assets":return"https://"+this.region+"-assets."+i;case"api":return"https://"+this.region+"."+i}}}var fn={icontains:(e,i)=>!!t&&i.href.toLowerCase().indexOf(e.toLowerCase())>-1,not_icontains:(e,i)=>!!t&&-1===i.href.toLowerCase().indexOf(e.toLowerCase()),regex:(e,i)=>!!t&&jr(i.href,e),not_regex:(e,i)=>!!t&&!jr(i.href,e),exact:(t,e)=>e.href===t,is_not:(t,e)=>e.href!==t};class pn{constructor(t){var e=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(t){void 0===t&&(t=!1),e.getWebExperiments((t=>{pn.wi("retrieved web experiments from the server"),e.xi=new Map,t.forEach((t=>{if(t.feature_flag_key){var i;if(e.xi)pn.wi("setting flag key ",t.feature_flag_key," to web experiment ",t),null==(i=e.xi)||i.set(t.feature_flag_key,t);var r=e._instance.getFeatureFlag(t.feature_flag_key);R(r)&&t.variants[r]&&e.$i(t.name,r,t.variants[r].transforms)}else if(t.variants)for(var s in t.variants){var n=t.variants[s];pn.Si(n)&&e.$i(t.name,s,n.transforms)}}))}),t)},this._instance=t,this._instance.onFeatureFlags((t=>{this.onFeatureFlags(t)}))}onFeatureFlags(t){if(this._is_bot())pn.wi("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(j(this.xi))return this.xi=new Map,this.loadIfEnabled(),void this.previewWebExperiment();pn.wi("applying feature flags",t),t.forEach((t=>{var e;if(this.xi&&null!=(e=this.xi)&&e.has(t)){var i,r=this._instance.getFeatureFlag(t),s=null==(i=this.xi)?void 0:i.get(t);r&&null!=s&&s.variants[r]&&this.$i(s.name,r,s.variants[r].transforms)}}))}}previewWebExperiment(){var t=pn.getWindowLocation();if(null!=t&&t.search){var e=Ai(null==t?void 0:t.search,"__experiment_id"),i=Ai(null==t?void 0:t.search,"__experiment_variant");e&&i&&(pn.wi("previewing web experiments "+e+" && "+i),this.getWebExperiments((t=>{this.Ei(parseInt(e),i,t)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(t,e,i){if(this._instance.config.disable_web_experiments&&!i)return t([]);var r=this._instance.get_property("$web_experiments");if(r&&!e)return t(r);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:e=>{if(200!==e.statusCode||!e.json)return t([]);var i=e.json.experiments||[];return t(i)}})}Ei(t,e,i){var r=i.filter((e=>e.id===t));r&&r.length>0&&(pn.wi("Previewing web experiment ["+r[0].name+"] with variant ["+e+"]"),this.$i(r[0].name,e,r[0].variants[e].transforms))}static Si(t){return!j(t.conditions)&&(pn.ki(t)&&pn.Pi(t))}static ki(t){var e;if(j(t.conditions)||j(null==(e=t.conditions)?void 0:e.url))return!0;var i,r,s,n=pn.getWindowLocation();return!!n&&(null==(i=t.conditions)||!i.url||fn[null!==(r=null==(s=t.conditions)?void 0:s.urlMatchType)&&void 0!==r?r:"icontains"](t.conditions.url,n))}static getWindowLocation(){return null==t?void 0:t.location}static Pi(t){var e;if(j(t.conditions)||j(null==(e=t.conditions)?void 0:e.utm))return!0;var i=Jr();if(i.utm_source){var r,s,n,o,a,l,u,h,d=null==(r=t.conditions)||null==(r=r.utm)||!r.utm_campaign||(null==(s=t.conditions)||null==(s=s.utm)?void 0:s.utm_campaign)==i.utm_campaign,v=null==(n=t.conditions)||null==(n=n.utm)||!n.utm_source||(null==(o=t.conditions)||null==(o=o.utm)?void 0:o.utm_source)==i.utm_source,c=null==(a=t.conditions)||null==(a=a.utm)||!a.utm_medium||(null==(l=t.conditions)||null==(l=l.utm)?void 0:l.utm_medium)==i.utm_medium,f=null==(u=t.conditions)||null==(u=u.utm)||!u.utm_term||(null==(h=t.conditions)||null==(h=h.utm)?void 0:h.utm_term)==i.utm_term;return d&&c&&f&&v}return!1}static wi(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];we.info("[WebExperiments] "+t,i)}$i(t,e,i){this._is_bot()?pn.wi("Refusing to render web experiment since the viewer is a likely bot"):"control"!==e?i.forEach((i=>{if(i.selector){var r;pn.wi("applying transform of variant "+e+" for experiment "+t+" ",i);var s=null==(r=document)?void 0:r.querySelectorAll(i.selector);null==s||s.forEach((t=>{var e=t;i.html&&(e.innerHTML=i.html),i.css&&e.setAttribute("style",i.css)}))}})):pn.wi("Control variants leave the page unmodified.")}_is_bot(){return n&&this._instance?hn(n,this._instance.config.custom_blocked_useragents):void 0}}var _n=xe("[PostHog ExternalIntegrations]"),gn={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class mn{constructor(t){this._instance=t}Fi(t,e){var i;null==(i=v.__PosthogExtensions__)||null==i.loadExternalDependency||i.loadExternalDependency(this._instance,t,(t=>{if(t)return _n.error("failed to load script",t);e()}))}startIfEnabledOrStop(){var t=this,e=function(e){var i,s,n;(!r||null!=(i=v.__PosthogExtensions__)&&null!=(i=i.integrations)&&i[e]||t.Fi(gn[e],(()=>{var i;null==(i=v.__PosthogExtensions__)||null==(i=i.integrations)||null==(i=i[e])||i.start(t._instance)})),!r&&null!=(s=v.__PosthogExtensions__)&&null!=(s=s.integrations)&&s[e])&&(null==(n=v.__PosthogExtensions__)||null==(n=n.integrations)||null==(n=n[e])||n.stop())};for(var[i,r]of Object.entries(null!==(s=this._instance.config.integrations)&&void 0!==s?s:{})){var s;e(i)}}}var yn={},bn=0,wn=()=>{},xn="posthog",$n=!Ir&&-1===(null==d?void 0:d.indexOf("MSIE"))&&-1===(null==d?void 0:d.indexOf("Mozilla")),Sn=e=>{var i;return _({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:je(null==o?void 0:o.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:wn,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:null!=e?e:"unset",__preview_deferred_init_extensions:!1,debug:a&&R(null==a?void 0:a.search)&&-1!==a.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==t||null==(i=t.location)?void 0:i.protocol),ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var e="Bad HTTP status: "+t.statusCode+" "+t.text;we.error(e)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:tn},error_tracking:{},_onCapture:wn,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(e))},En=t=>{var e={};O(t.process_person)||(e.person_profiles=t.process_person),O(t.xhr_headers)||(e.request_headers=t.xhr_headers),O(t.cookie_name)||(e.persistence_name=t.cookie_name),O(t.disable_cookie)||(e.disable_persistence=t.disable_cookie),O(t.store_google)||(e.save_campaign_params=t.store_google),O(t.verbose)||(e.debug=t.verbose);var i=Fe({},e,t);return P(t.property_blacklist)&&(O(t.property_denylist)?i.property_denylist=t.property_blacklist:P(t.property_denylist)?i.property_denylist=[...t.property_blacklist,...t.property_denylist]:we.error("Invalid value for property_denylist config: "+t.property_denylist)),i};class kn{constructor(){this.__forceAllowLocalhost=!1}get Ii(){return this.__forceAllowLocalhost}set Ii(t){we.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=t}}class Pn{get decideEndpointWasHit(){var t,e;return null!==(t=null==(e=this.featureFlags)?void 0:e.hasLoadedFlags)&&void 0!==t&&t}get flagsEndpointWasHit(){var t,e;return null!==(t=null==(e=this.featureFlags)?void 0:e.hasLoadedFlags)&&void 0!==t&&t}constructor(){this.webPerformance=new kn,this.Ti=!1,this.version=c.LIB_VERSION,this._t=new zs,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=Sn(),this.SentryIntegration=Ci,this.sentryIntegration=t=>function(t,e){var i=Mi(t,e);return{name:Ri,processEvent:t=>i(t)}}(this,t),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Oi=!1,this.Ri=null,this.Mi=null,this.Ci=null,this.featureFlags=new ws(this),this.toolbar=new qi(this),this.scrollManager=new nn(this),this.pageViewManager=new Wi(this),this.surveys=new Gs(this),this.conversations=new Vs(this),this.logs=new Ks(this),this.experiments=new pn(this),this.exceptions=new zr(this),this.rateLimiter=new Xs(this),this.requestRouter=new cn(this),this.consent=new Fi(this),this.externalIntegrations=new mn(this),this.people={set:(t,e,i)=>{var r=R(t)?{[t]:e}:t;this.setPersonProperties(r),null==i||i({})},set_once:(t,e,i)=>{var r=R(t)?{[t]:e}:t;this.setPersonProperties(void 0,r),null==i||i({})}},this.on("eventCaptured",(t=>we.info('send "'+(null==t?void 0:t.event)+'"',t)))}init(t,e,i){if(i&&i!==xn){var r,s=null!==(r=yn[i])&&void 0!==r?r:new Pn;return s._init(t,e,i),yn[i]=s,yn[xn][i]=s,s}return this._init(t,e,i)}_init(e,i,r){var s;if(void 0===i&&(i={}),O(e)||M(e))return we.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},i.debug=this.ji(i.debug),this.Di=i,this.Ai=[],i.person_profiles?this.Mi=i.person_profiles:i.process_person&&(this.Mi=i.process_person),this.set_config(Fe({},Sn(i.defaults),En(i),{name:r,token:e})),this.config.on_xhr_error&&we.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=i.disable_compression?void 0:Ji.GZipJS;var n=this.Ni();this.persistence=new $s(this.config,n),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new $s(_({},this.config,{persistence:"sessionStorage"}),n);var o=_({},this.persistence.props),a=_({},this.sessionPersistence.props);this.register({$initialization_time:(new Date).toISOString()}),this.Ui=new en((t=>this.Li(t)),this.config.request_queue_config),this.zi=new sn(this),this.__request_queue=[];var l="always"===this.config.cookieless_mode||"on_reject"===this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut();if(l||(this.sessionManager=new un(this),this.sessionPropsManager=new an(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(we.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.Bi(l)}),0)):(we.info("Initializing extensions synchronously"),this.Bi(l)),c.DEBUG=c.DEBUG||this.config.debug,c.DEBUG&&we.info("Starting in debug mode",{this:this,config:i,thisC:_({},this.config),p:o,s:a}),void 0!==(null==(s=i.bootstrap)?void 0:s.distinctID)){var u,h,d=this.config.get_device_id(fi()),v=null!=(u=i.bootstrap)&&u.isIdentifiedID?d:i.bootstrap.distinctID;this.persistence.set_property(Ze,null!=(h=i.bootstrap)&&h.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:i.bootstrap.distinctID,$device_id:v})}if(this.Hi()){var f,p,g=Object.keys((null==(f=i.bootstrap)?void 0:f.featureFlags)||{}).filter((t=>{var e;return!(null==(e=i.bootstrap)||null==(e=e.featureFlags)||!e[t])})).reduce(((t,e)=>{var r;return t[e]=(null==(r=i.bootstrap)||null==(r=r.featureFlags)?void 0:r[e])||!1,t}),{}),m=Object.keys((null==(p=i.bootstrap)?void 0:p.featureFlagPayloads)||{}).filter((t=>g[t])).reduce(((t,e)=>{var r,s;null!=(r=i.bootstrap)&&null!=(r=r.featureFlagPayloads)&&r[e]&&(t[e]=null==(s=i.bootstrap)||null==(s=s.featureFlagPayloads)?void 0:s[e]);return t}),{});this.featureFlags.receivedFeatureFlags({featureFlags:g,featureFlagPayloads:m})}if(l)this.register_once({distinct_id:oi,$device_id:null},"");else if(!this.get_distinct_id()){var y=this.config.get_device_id(fi());this.register_once({distinct_id:y,$device_id:y},""),this.persistence.set_property(Ze,"anonymous")}return Ae(t,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),i.segment?Oi(this,(()=>this.qi())):this.qi(),F(this.config._onCapture)&&this.config._onCapture!==wn&&(we.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(t=>this.config._onCapture(t.event,t)))),this.config.ip&&we.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}Bi(t){var e=performance.now(),i=_({},Pn.__defaultExtensionClasses,this.config.__extensionClasses);i.historyAutocapture&&(this.historyAutocapture=new i.historyAutocapture(this),this.historyAutocapture.startIfEnabled());var r=[];i.tracingHeaders&&r.push((()=>{new i.tracingHeaders(this).startIfEnabledOrStop()})),i.siteApps&&r.push((()=>{var t;this.siteApps=new i.siteApps(this),null==(t=this.siteApps)||t.init()})),!t&&i.sessionRecording&&r.push((()=>{this.sessionRecording=new i.sessionRecording(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||r.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),i.autocapture&&r.push((()=>{this.autocapture=new i.autocapture(this),this.autocapture.startIfEnabled()})),r.push((()=>{this.surveys.loadIfEnabled()})),r.push((()=>{this.logs.loadIfEnabled()})),r.push((()=>{this.conversations.loadIfEnabled()})),i.productTours&&r.push((()=>{this.productTours=new i.productTours(this),this.productTours.loadIfEnabled()})),i.heatmaps&&r.push((()=>{this.heatmaps=new i.heatmaps(this),this.heatmaps.startIfEnabled()})),i.webVitalsAutocapture&&r.push((()=>{this.webVitalsAutocapture=new i.webVitalsAutocapture(this)})),i.exceptionObserver&&r.push((()=>{this.exceptionObserver=new i.exceptionObserver(this),this.exceptionObserver.startIfEnabledOrStop()})),i.deadClicksAutocapture&&r.push((()=>{this.deadClicksAutocapture=new i.deadClicksAutocapture(this,Ii),this.deadClicksAutocapture.startIfEnabledOrStop()})),r.push((()=>{if(this.Wi){var t=this.Wi;this.Wi=void 0,this.Fe(t)}})),this.Gi(r,e)}Gi(t,e){for(;t.length>0;){if(this.config.__preview_deferred_init_extensions)if(performance.now()-e>=30&&t.length>0)return void setTimeout((()=>{this.Gi(t,e)}),0);var i=t.shift();if(i)try{i()}catch(t){we.error("Error initializing extension:",t)}}var r=Math.round(performance.now()-e);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:r}),this.config.__preview_deferred_init_extensions&&we.info("PostHog extensions initialized ("+r+"ms)")}Fe(t){var e,i,r,s,n,a,l,u,h;if(!o||!o.body)return we.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.Fe(t)}),500);this.config.__preview_deferred_init_extensions&&(this.Wi=t),this.compression=void 0,t.supportedCompression&&!this.config.disable_compression&&(this.compression=b(t.supportedCompression,Ji.GZipJS)?Ji.GZipJS:b(t.supportedCompression,Ji.Base64)?Ji.Base64:void 0),null!=(e=t.analytics)&&e.endpoint&&(this.analyticsDefaultEndpoint=t.analytics.endpoint),this.set_config({person_profiles:this.Mi?this.Mi:"identified_only"}),null==(i=this.siteApps)||i.onRemoteConfig(t),null==(r=this.sessionRecording)||r.onRemoteConfig(t),null==(s=this.autocapture)||s.onRemoteConfig(t),null==(n=this.heatmaps)||n.onRemoteConfig(t),this.surveys.onRemoteConfig(t),this.logs.onRemoteConfig(t),this.conversations.onRemoteConfig(t),null==(a=this.productTours)||a.onRemoteConfig(t),null==(l=this.webVitalsAutocapture)||l.onRemoteConfig(t),null==(u=this.exceptionObserver)||u.onRemoteConfig(t),this.exceptions.onRemoteConfig(t),null==(h=this.deadClicksAutocapture)||h.onRemoteConfig(t)}qi(){try{this.config.loaded(this)}catch(t){we.critical("`loaded` function failed",t)}if(this.Ji(),this.config.internal_or_test_user_hostname&&null!=a&&a.hostname){var t=a.hostname,e=this.config.internal_or_test_user_hostname;("string"==typeof e?t===e:e.test(t))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||"always"===this.config.cookieless_mode)&&this.Vi()}),1),this.Ki=new Zs(this),this.Ki.load()}Ji(){var t;this.is_capturing()&&(this.config.request_batching&&(null==(t=this.Ui)||t.enable()))}_dom_loaded(){this.is_capturing()&&ke(this.__request_queue,(t=>this.Li(t))),this.__request_queue=[],this.Ji()}_handle_unload(){var t,e;this.surveys.handlePageUnload(),this.config.request_batching?(this.Yi()&&this.capture("$pageleave"),null==(t=this.Ui)||t.unload(),null==(e=this.zi)||e.unload()):this.Yi()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(t){this.__loaded&&($n?this.__request_queue.push(t):this.rateLimiter.isServerRateLimited(t.batchKey)||(t.transport=t.transport||this.config.api_transport,t.url=Or(t.url,{ip:this.config.ip?1:0}),t.headers=_({},this.config.request_headers,t.headers),t.compression="best-available"===t.compression?this.compression:t.compression,t.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(t.disableTransport=["sendBeacon"]),t.fetchOptions=t.fetchOptions||this.config.fetch_options,(t=>{var e,i,r,s=_({},t);s.timeout=s.timeout||6e4,s.url=Or(s.url,{_:(new Date).getTime().toString(),ver:c.LIB_VERSION,compression:s.compression});var n=null!==(e=s.transport)&&void 0!==e?e:"fetch",o=Cr.filter((t=>!s.disableTransport||!t.transport||!s.disableTransport.includes(t.transport))),a=null!==(i=null==(r=De(o,(t=>t.transport===n)))?void 0:r.method)&&void 0!==i?i:o[0].method;if(!a)throw new Error("No available transport method");a(s)})(_({},t,{callback:e=>{var i,r;(this.rateLimiter.checkForLimiting(e),e.statusCode>=400)&&(null==(i=(r=this.config).on_request_error)||i.call(r,e));null==t.callback||t.callback(e)}}))))}Li(t){this.zi?this.zi.retriableRequest(t):this._send_request(t)}_execute_array(t){bn++;try{var e,i=[],r=[],s=[];ke(t,(t=>{t&&(e=t[0],P(e)?s.push(t):F(t)?t.call(this):P(t)&&"alias"===e?i.push(t):P(t)&&-1!==e.indexOf("capture")&&F(this[e])?s.push(t):r.push(t))}));var n=function(t,e){ke(t,(function(t){if(P(t[0])){var i=e;Pe(t,(function(t){i=i[t[0]].apply(i,t.slice(1))}))}else this[t[0]].apply(this,t.slice(1))}),e)};n(i,this),n(r,this),n(s,this)}finally{bn--}}Hi(){var t,e;return(null==(t=this.config.bootstrap)?void 0:t.featureFlags)&&Object.keys(null==(e=this.config.bootstrap)?void 0:e.featureFlags).length>0||!1}push(t){if(bn>0&&P(t)&&R(t[0])){var e=Pn.prototype[t[0]];F(e)&&e.apply(this,t.slice(1))}else this._execute_array([t])}capture(t,e,i){var r;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Ui){if(this.is_capturing())if(!O(t)&&R(t)){var s=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(s&&!this.config.__preview_capture_bot_pageviews)){var n=null!=i&&i.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==n||!n.isRateLimited){null!=e&&e.$current_url&&!R(null==e?void 0:e.$current_url)&&(we.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),null==e||delete e.$current_url),"$exception"!==t||null!=i&&i.it||we.warn("Using `posthog.capture('$exception')` is unreliable because it does not attach required metadata. Use `posthog.captureException(error)` instead, which attaches required metadata automatically."),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var o=new Date,a=(null==i?void 0:i.timestamp)||o,l=fi(),u={uuid:l,event:t,properties:this.calculateEventProperties(t,e||{},a,l)};"$pageview"===t&&this.config.__preview_capture_bot_pageviews&&s&&(u.event="$bot_pageview",u.properties.$browser_type="bot"),n&&(u.properties.$lib_rate_limit_remaining_tokens=n.remainingTokens),(null==i?void 0:i.$set)&&(u.$set=null==i?void 0:i.$set);var h,d="$groupidentify"!==t,v=this.Xi(null==i?void 0:i.$set_once,d);if(v&&(u.$set_once=v),(u=Me(u,null!=i&&i._noTruncate?null:this.config.properties_string_max_length)).timestamp=a,O(null==i?void 0:i.timestamp)||(u.properties.$event_time_override_provided=!0,u.properties.$event_time_override_system_time=o),t===Rs.DISMISSED||t===Rs.SENT){var c=null==e?void 0:e[Ms.SURVEY_ID],f=null==e?void 0:e[Ms.SURVEY_ITERATION];h={id:c,current_iteration:f},localStorage.getItem(Ns(h))||localStorage.setItem(Ns(h),"true"),u.$set=_({},u.$set,{[As({id:c,current_iteration:f},t===Rs.SENT?"responded":"dismissed")]:!0})}else t===Rs.SHOWN&&(u.$set=_({},u.$set,{[Ms.SURVEY_LAST_SEEN_DATE]:(new Date).toISOString()}));var p=_({},u.properties.$set,u.$set);if(T(p)||this.setPersonPropertiesForFlags(p),!j(this.config.before_send)){var g=this.Qi(u);if(!g)return;u=g}this._t.emit("eventCaptured",u);var m={method:"POST",url:null!==(r=null==i?void 0:i._url)&&void 0!==r?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:u,compression:"best-available",batchKey:null==i?void 0:i._batchKey};return!this.config.request_batching||i&&(null==i||!i._batchKey)||null!=i&&i.send_instantly?this.Li(m):this.Ui.enqueue(m),u}we.critical("This capture call is ignored due to client rate limiting.")}}else we.error("No event name provided to posthog.capture")}else we.uninitializedWarning("posthog.capture")}_addCaptureHook(t){return this.on("eventCaptured",(e=>t(e.event,e)))}calculateEventProperties(t,e,i,r,s){if(i=i||new Date,!this.persistence||!this.sessionPersistence)return e;var n=s?void 0:this.persistence.remove_event_timer(t),a=_({},e);if(a.token=this.config.token,a.$config_defaults=this.config.defaults,("always"==this.config.cookieless_mode||"on_reject"==this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut())&&(a.$cookieless_mode=!0),"$snapshot"===t){var l=_({},this.persistence.properties(),this.sessionPersistence.properties());return a.distinct_id=l.distinct_id,(!R(a.distinct_id)&&!D(a.distinct_id)||M(a.distinct_id))&&we.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var u,h=is(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:v,windowId:c}=this.sessionManager.checkAndGetSessionAndWindowId(s,i.getTime());a.$session_id=v,a.$window_id=c}this.sessionPropsManager&&Fe(a,this.sessionPropsManager.getSessionProps());try{var f;this.sessionRecording&&Fe(a,this.sessionRecording.sdkDebugProperties),a.$sdk_debug_retry_queue_size=null==(f=this.zi)?void 0:f.length}catch(t){a.$sdk_debug_error_capturing_properties=String(t)}if(this.requestRouter.region===dn.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),u="$pageview"!==t||s?"$pageleave"!==t||s?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(i):this.pageViewManager.doPageView(i,r),a=Fe(a,u),"$pageview"===t&&o&&(a.title=o.title),!O(n)){var p=i.getTime()-n;a.$duration=parseFloat((p/1e3).toFixed(3))}d&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=Fe({},h,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),P(this.config.property_denylist)?Pe(this.config.property_denylist,(function(t){delete a[t]})):we.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var g=this.config.sanitize_properties;g&&(we.error("sanitize_properties is deprecated. Use before_send instead"),a=g(a,t));var m=this.Zi();return a.$process_person_profile=m,m&&!s&&this.tr("_calculate_event_properties"),a}Xi(t,e){var i;if(void 0===e&&(e=!0),!this.persistence||!this.Zi())return t;if(this.Ti)return t;var r=this.persistence.get_initial_props(),s=null==(i=this.sessionPropsManager)?void 0:i.getSetOnceProps(),n=Fe({},r,s||{},t||{}),o=this.config.sanitize_properties;return o&&(we.error("sanitize_properties is deprecated. Use before_send instead"),n=o(n,"$set_once")),e&&(this.Ti=!0),T(n)?void 0:n}register(t,e){var i;null==(i=this.persistence)||i.register(t,e)}register_once(t,e,i){var r;null==(r=this.persistence)||r.register_once(t,e,i)}register_for_session(t){var e;null==(e=this.sessionPersistence)||e.register(t)}unregister(t){var e;null==(e=this.persistence)||e.unregister(t)}unregister_for_session(t){var e;null==(e=this.sessionPersistence)||e.unregister(t)}er(t,e){this.register({[t]:e})}getFeatureFlag(t,e){return this.featureFlags.getFeatureFlag(t,e)}getFeatureFlagPayload(t){return this.featureFlags.getFeatureFlagPayload(t)}getFeatureFlagResult(t,e){return this.featureFlags.getFeatureFlagResult(t,e)}isFeatureEnabled(t,e){return this.featureFlags.isFeatureEnabled(t,e)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(t,e,i){var r=null!=i&&i.merge?this.featureFlags.getFlagVariants():{},s=null!=i&&i.merge?this.featureFlags.getFlagPayloads():{},n=_({},r,t),o=_({},s,e),a={};for(var[l,u]of Object.entries(n)){var h="string"==typeof u;a[l]={key:l,enabled:!!h||Boolean(u),variant:h?u:void 0,reason:void 0,metadata:O(null==o?void 0:o[l])?void 0:{id:0,version:void 0,description:void 0,payload:o[l]}}}this.featureFlags.receivedFeatureFlags({flags:a})}updateEarlyAccessFeatureEnrollment(t,e,i){this.featureFlags.updateEarlyAccessFeatureEnrollment(t,e,i)}getEarlyAccessFeatures(t,e,i){return void 0===e&&(e=!1),this.featureFlags.getEarlyAccessFeatures(t,e,i)}on(t,e){return this._t.on(t,e)}onFeatureFlags(t){return this.featureFlags.onFeatureFlags(t)}onSurveysLoaded(t){return this.surveys.onSurveysLoaded(t)}onSessionId(t){var e,i;return null!==(e=null==(i=this.sessionManager)?void 0:i.onSessionId(t))&&void 0!==e?e:()=>{}}getSurveys(t,e){void 0===e&&(e=!1),this.surveys.getSurveys(t,e)}getActiveMatchingSurveys(t,e){void 0===e&&(e=!1),this.surveys.getActiveMatchingSurveys(t,e)}renderSurvey(t,e){this.surveys.renderSurvey(t,e)}displaySurvey(t,e){void 0===e&&(e=Ls),this.surveys.displaySurvey(t,e)}cancelPendingSurvey(t){this.surveys.cancelPendingSurvey(t)}canRenderSurvey(t){return this.surveys.canRenderSurvey(t)}canRenderSurveyAsync(t,e){return void 0===e&&(e=!1),this.surveys.canRenderSurveyAsync(t,e)}identify(t,e,i){if(!this.__loaded||!this.persistence)return we.uninitializedWarning("posthog.identify");if(D(t)&&(t=t.toString(),we.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),t)if(["distinct_id","distinctid"].includes(t.toLowerCase()))we.critical('The string "'+t+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(t!==oi){if(this.tr("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:t}),!this.get_property("$device_id")){var s=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:s},"")}t!==r&&t!==this.get_property(Le)&&(this.unregister(Le),this.register({distinct_id:t}));var n="anonymous"===(this.persistence.get_property(Ze)||"anonymous");t!==r&&n?(this.persistence.set_property(Ze,"identified"),this.setPersonPropertiesForFlags(_({},i||{},e||{}),!1),this.capture("$identify",{distinct_id:t,$anon_distinct_id:r},{$set:e||{},$set_once:i||{}}),this.Ci=Dr(t,e,i),this.featureFlags.setAnonymousDistinctId(r)):(e||i)&&this.setPersonProperties(e,i),t!==r&&(this.reloadFeatureFlags(),this.unregister(Xe))}}else we.critical('The string "'+oi+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else we.error("Unique user id has not been set in posthog.identify")}setPersonProperties(t,e){if((t||e)&&this.tr("posthog.setPersonProperties")){var i=Dr(this.get_distinct_id(),t,e);this.Ci!==i?(this.setPersonPropertiesForFlags(_({},e||{},t||{})),this.capture("$set",{$set:t||{},$set_once:e||{}}),this.Ci=i):we.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(t,e,i){if(t&&e){var r=this.getGroups();r[t]!==e&&this.resetGroupPropertiesForFlags(t),this.register({$groups:_({},r,{[t]:e})}),i&&(this.capture("$groupidentify",{$group_type:t,$group_key:e,$group_set:i}),this.setGroupPropertiesForFlags({[t]:i})),r[t]===e||i||this.reloadFeatureFlags()}else we.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(t,e){void 0===e&&(e=!0),this.featureFlags.setPersonPropertiesForFlags(t,e)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(t,e){void 0===e&&(e=!0),this.tr("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(t,e)}resetGroupPropertiesForFlags(t){this.featureFlags.resetGroupPropertiesForFlags(t)}reset(t){var e,i,r,s,n;if(we.info("reset"),!this.__loaded)return we.uninitializedWarning("posthog.reset");var o=this.get_property("$device_id");if(this.consent.reset(),null==(e=this.persistence)||e.clear(),null==(i=this.sessionPersistence)||i.clear(),this.surveys.reset(),null==(r=this.Ki)||r.stop(),this.featureFlags.reset(),null==(s=this.persistence)||s.set_property(Ze,"anonymous"),null==(n=this.sessionManager)||n.resetSessionId(),this.Ci=null,"always"===this.config.cookieless_mode)this.register_once({distinct_id:oi,$device_id:null},"");else{var a=this.config.get_device_id(fi());this.register_once({distinct_id:a,$device_id:t?a:o},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var t,e;return null!==(t=null==(e=this.sessionManager)?void 0:e.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==t?t:""}get_session_replay_url(t){if(!this.sessionManager)return"";var{sessionId:e,sessionStartTimestamp:i}=this.sessionManager.checkAndGetSessionAndWindowId(!0),r=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+e);if(null!=t&&t.withTimestamp&&i){var s,n=null!==(s=t.timestampLookBack)&&void 0!==s?s:10;if(!i)return r;r+="?t="+Math.max(Math.floor(((new Date).getTime()-i)/1e3)-n,0)}return r}alias(t,e){return t===this.get_property(Ue)?(we.critical("Attempting to create alias for existing People user - aborting."),-2):this.tr("posthog.alias")?(O(e)&&(e=this.get_distinct_id()),t!==e?(this.er(Le,t),this.capture("$create_alias",{alias:t,distinct_id:e})):(we.warn("alias matches current distinct_id - skipping api call."),this.identify(t),-1)):void 0}set_config(t){var e=_({},this.config);if(I(t)){var i,r,s,n,o,a,l,u;Fe(this.config,En(t));var h=this.Ni();null==(i=this.persistence)||i.update_config(this.config,e,h),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new $s(_({},this.config,{persistence:"sessionStorage"}),h);var d=this.ji(this.config.debug);N(d)&&(this.config.debug=d),N(this.config.debug)&&(this.config.debug?(c.DEBUG=!0,wi.k()&&wi.T("ph_debug","true"),we.info("set_config",{config:t,oldConfig:e,newConfig:_({},this.config)})):(c.DEBUG=!1,wi.k()&&wi.O("ph_debug"))),null==(r=this.exceptionObserver)||r.onConfigChange(),null==(s=this.sessionRecording)||s.startIfEnabledOrStop(),null==(n=this.autocapture)||n.startIfEnabled(),null==(o=this.heatmaps)||o.startIfEnabled(),null==(a=this.exceptionObserver)||a.startIfEnabledOrStop(),null==(l=this.deadClicksAutocapture)||l.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this.ir(),null==(u=this.externalIntegrations)||u.startIfEnabledOrStop()}}startSessionRecording(t){var e=!0===t,i={sampling:e||!(null==t||!t.sampling),linked_flag:e||!(null==t||!t.linked_flag),url_trigger:e||!(null==t||!t.url_trigger),event_trigger:e||!(null==t||!t.event_trigger)};if(Object.values(i).some(Boolean)){var r,s,n,o,a;if(null==(r=this.sessionManager)||r.checkAndGetSessionAndWindowId(),i.sampling)null==(s=this.sessionRecording)||s.overrideSampling();if(i.linked_flag)null==(n=this.sessionRecording)||n.overrideLinkedFlag();if(i.url_trigger)null==(o=this.sessionRecording)||o.overrideTrigger("url");if(i.event_trigger)null==(a=this.sessionRecording)||a.overrideTrigger("event")}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var t;return!(null==(t=this.sessionRecording)||!t.started)}captureException(t,e){var i=new Error("PostHog syntheticException"),r=this.exceptions.buildProperties(t,{handled:!0,syntheticException:i});return this.exceptions.sendExceptionEvent(_({},r,e))}startExceptionAutocapture(t){this.set_config({capture_exceptions:null==t||t})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(t){return this.toolbar.loadToolbar(t)}get_property(t){var e;return null==(e=this.persistence)?void 0:e.props[t]}getSessionProperty(t){var e;return null==(e=this.sessionPersistence)?void 0:e.props[t]}toString(){var t,e=null!==(t=this.config.name)&&void 0!==t?t:xn;return e!==xn&&(e=xn+"."+e),e}_isIdentified(){var t,e;return"identified"===(null==(t=this.persistence)?void 0:t.get_property(Ze))||"identified"===(null==(e=this.sessionPersistence)?void 0:e.get_property(Ze))}Zi(){var t,e;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&T(this.getGroups())&&(null==(t=this.persistence)||null==(t=t.props)||!t[Le])&&(null==(e=this.persistence)||null==(e=e.props)||!e[ni]))}Yi(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&(!0===this.config.capture_pageview||"history_change"===this.config.capture_pageview)}createPersonProfile(){this.Zi()||this.tr("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.tr("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}tr(t){return"never"===this.config.person_profiles?(we.error(t+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.er(ni,!0),!0)}Ni(){if("always"===this.config.cookieless_mode)return!0;var t=this.consent.isOptedOut(),e=this.config.opt_out_persistence_by_default||"on_reject"===this.config.cookieless_mode;return this.config.disable_persistence||t&&!!e}ir(){var t,e,i,r,s=this.Ni();(null==(t=this.persistence)?void 0:t.Pt)!==s&&(null==(i=this.persistence)||i.set_disabled(s));(null==(e=this.sessionPersistence)?void 0:e.Pt)!==s&&(null==(r=this.sessionPersistence)||r.set_disabled(s));return s}opt_in_capturing(t){var e;if("always"!==this.config.cookieless_mode){if("on_reject"===this.config.cookieless_mode&&this.consent.isExplicitlyOptedOut()){var i,r,s,n,o;this.reset(!0),null==(i=this.sessionManager)||i.destroy(),null==(r=this.pageViewManager)||r.destroy(),this.sessionManager=new un(this),this.pageViewManager=new Wi(this),this.persistence&&(this.sessionPropsManager=new an(this,this.sessionManager,this.persistence));var a=null!==(s=null==(n=this.config.__extensionClasses)?void 0:n.sessionRecording)&&void 0!==s?s:null==(o=Pn.__defaultExtensionClasses)?void 0:o.sessionRecording;a&&(this.sessionRecording=new a(this),this.sessionRecording.startIfEnabledOrStop())}var l;if(this.consent.optInOut(!0),this.ir(),this.Ji(),null==(e=this.sessionRecording)||e.startIfEnabledOrStop(),"on_reject"==this.config.cookieless_mode&&this.surveys.loadIfEnabled(),O(null==t?void 0:t.captureEventName)||null!=t&&t.captureEventName)this.capture(null!==(l=null==t?void 0:t.captureEventName)&&void 0!==l?l:"$opt_in",null==t?void 0:t.captureProperties,{send_instantly:!0});this.config.capture_pageview&&this.Vi()}else we.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var t,e,i;"always"!==this.config.cookieless_mode?("on_reject"===this.config.cookieless_mode&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this.ir(),"on_reject"===this.config.cookieless_mode&&(this.register({distinct_id:oi,$device_id:null}),null==(t=this.sessionManager)||t.destroy(),null==(e=this.pageViewManager)||e.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,null==(i=this.sessionRecording)||i.stopRecording(),this.sessionRecording=void 0,this.Vi())):we.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var t=this.consent.consent;return t===Pi.GRANTED?"granted":t===Pi.DENIED?"denied":"pending"}is_capturing(){return"always"===this.config.cookieless_mode||("on_reject"===this.config.cookieless_mode?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this.ir()}_is_bot(){return n?hn(n,this.config.custom_blocked_useragents):void 0}Vi(){o&&("visible"===o.visibilityState?this.Oi||(this.Oi=!0,this.capture("$pageview",{title:o.title},{send_instantly:!0}),this.Ri&&(o.removeEventListener("visibilitychange",this.Ri),this.Ri=null)):this.Ri||(this.Ri=this.Vi.bind(this),Ae(o,"visibilitychange",this.Ri)))}debug(e){!1===e?(null==t||t.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(null==t||t.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}wt(){var t,e,i,r,s,n,o,a=this.Di||{};return"advanced_disable_flags"in a?!!a.advanced_disable_flags:!1!==this.config.advanced_disable_flags?!!this.config.advanced_disable_flags:!0===this.config.advanced_disable_decide?(we.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(i="advanced_disable_decide",r=!1,s=we,n=(e="advanced_disable_flags")in(t=a)&&!j(t[e]),o=i in t&&!j(t[i]),n?t[e]:o?(s&&s.warn("Config field '"+i+"' is deprecated. Please use '"+e+"' instead. The old field will be removed in a future major version."),t[i]):r)}Qi(t){if(j(this.config.before_send))return t;var e=P(this.config.before_send)?this.config.before_send:[this.config.before_send],i=t;for(var r of e){if(i=r(i),j(i)){var s="Event '"+t.event+"' was rejected in beforeSend function";return L(t.event)?we.warn(s+". This can cause unexpected behavior."):we.info(s),null}i.properties&&!T(i.properties)||we.warn("Event '"+t.event+"' has no properties after beforeSend function, this is likely an error.")}return i}getPageViewId(){var t;return null==(t=this.pageViewManager.q)?void 0:t.pageViewId}captureTraceFeedback(t,e){this.capture("$ai_feedback",{$ai_trace_id:String(t),$ai_feedback_text:e})}captureTraceMetric(t,e,i){this.capture("$ai_metric",{$ai_trace_id:String(t),$ai_metric_name:e,$ai_metric_value:String(i)})}ji(t){var e=N(t)&&!t,i=wi.k()&&"true"===wi.F("ph_debug");return!e&&(!!i||t)}}Pn.__defaultExtensionClasses={},function(t,e){for(var i=0;i<e.length;i++)t.prototype[e[i]]=Oe(t.prototype[e[i]])}(Pn,["identify"]);var Fn,In={backgroundColor:"#ffffff",textColor:"#1d1f27",buttonColor:"#1d1f27",borderRadius:8,buttonBorderRadius:6,borderColor:"#e5e7eb",fontFamily:"system-ui",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",showOverlay:!0,whiteLabel:!1,dismissOnClickOutside:!0,zIndex:2147483646},Tn=function(t){return t.SHOWN="product tour shown",t.DISMISSED="product tour dismissed",t.COMPLETED="product tour completed",t.STEP_SHOWN="product tour step shown",t.STEP_COMPLETED="product tour step completed",t.BUTTON_CLICKED="product tour button clicked",t.STEP_SELECTOR_FAILED="product tour step selector failed",t.BANNER_CONTAINER_SELECTOR_FAILED="product tour banner container selector failed",t.BANNER_ACTION_CLICKED="product tour banner action clicked",t}({}),On=function(t){return t.TOUR_ID="$product_tour_id",t.TOUR_NAME="$product_tour_name",t.TOUR_ITERATION="$product_tour_iteration",t.TOUR_RENDER_REASON="$product_tour_render_reason",t.TOUR_STEP_ID="$product_tour_step_id",t.TOUR_STEP_ORDER="$product_tour_step_order",t.TOUR_STEP_TYPE="$product_tour_step_type",t.TOUR_DISMISS_REASON="$product_tour_dismiss_reason",t.TOUR_BUTTON_TEXT="$product_tour_button_text",t.TOUR_BUTTON_ACTION="$product_tour_button_action",t.TOUR_BUTTON_LINK="$product_tour_button_link",t.TOUR_BUTTON_TOUR_ID="$product_tour_button_tour_id",t.TOUR_STEPS_COUNT="$product_tour_steps_count",t.TOUR_STEP_SELECTOR="$product_tour_step_selector",t.TOUR_STEP_SELECTOR_FOUND="$product_tour_step_selector_found",t.TOUR_STEP_ELEMENT_TAG="$product_tour_step_element_tag",t.TOUR_STEP_ELEMENT_ID="$product_tour_step_element_id",t.TOUR_STEP_ELEMENT_CLASSES="$product_tour_step_element_classes",t.TOUR_STEP_ELEMENT_TEXT="$product_tour_step_element_text",t.TOUR_ERROR="$product_tour_error",t.TOUR_MATCHES_COUNT="$product_tour_matches_count",t.TOUR_FAILURE_PHASE="$product_tour_failure_phase",t.TOUR_WAITED_FOR_ELEMENT="$product_tour_waited_for_element",t.TOUR_WAIT_DURATION_MS="$product_tour_wait_duration_ms",t.TOUR_BANNER_SELECTOR="$product_tour_banner_selector",t.TOUR_LINKED_SURVEY_ID="$product_tour_linked_survey_id",t.USE_MANUAL_SELECTOR="$use_manual_selector",t.INFERENCE_DATA_PRESENT="$inference_data_present",t}({}),Rn=(Fn=yn[xn]=new Pn,function(){function e(){e.done||(e.done=!0,$n=!1,Pe(yn,(function(t){t._dom_loaded()})))}null!=o&&o.addEventListener?"complete"===o.readyState?e():Ae(o,"DOMContentLoaded",e,{capture:!1}):t&&we.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),Fn);console.warn("[PostHog Experimental] The slim module is experimental and may break or change on any release. Please use with caution and report any issues you encounter.");export{Ji as Compression,In as DEFAULT_PRODUCT_TOUR_APPEARANCE,Cs as DisplaySurveyType,Pn as PostHog,Tn as ProductTourEventName,On as ProductTourEventProperties,Rs as SurveyEventName,Ms as SurveyEventProperties,Ss as SurveyEventType,ks as SurveyPosition,Ts as SurveyQuestionBranchingType,Is as SurveyQuestionType,Os as SurveySchedule,Ps as SurveyTabPosition,Fs as SurveyType,Es as SurveyWidgetType,Rn as default,Rn as posthog,Gi as severityLevels};
//# sourceMappingURL=module.slim.js.map
